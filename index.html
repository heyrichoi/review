<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í´ë˜ì‹œ ë¡œì–„ ì›”ê°„ ì»¤ë®¤ë‹ˆí‹° ë¦¬ë·° ì‹œìŠ¤í…œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #1a1a1a;
            --secondary: #ffffff;
            --accent: #4f46e5;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --info: #06b6d4;
            --border: #e5e7eb;
            --hover: #f9fafb;
            --text: #111827;
            --text-muted: #6b7280;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --transition: all 0.2s ease;
            
            /* ë¸Œëœë“œ ì»¬ëŸ¬ */
            --clash-blue: #1e3a8a;
            --clash-gold: #f59e0b;
            --youtube-red: #ff0000;
            --naver-green: #00c73c;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body { 
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: #f8fafc;
            color: var(--text); 
            line-height: 1.6;
        }

        .container { display: flex; min-height: 100vh; }

        .sidebar {
            width: 300px;
            background: var(--secondary);
            box-shadow: var(--shadow-lg);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border);
        }

        .sidebar-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--clash-blue), var(--clash-gold));
            color: white;
            text-align: center;
        }

        .sidebar-header h1 { 
            font-size: 16px; 
            font-weight: 700; 
            margin-bottom: 8px;
        }

        .sidebar-header .subtitle {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 16px;
        }

        .period-selector {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .period-selector select {
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 13px;
            font-weight: 500;
            appearance: none;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .period-selector select:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .current-period {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .nav-menu { padding: 16px 0; }

        .nav-section {
            padding: 12px 20px 8px;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: var(--transition);
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
        }

        .nav-item::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--accent);
            margin-right: 12px;
            opacity: 0;
            transition: var(--transition);
        }

        .nav-item:hover, .nav-item.active {
            background: linear-gradient(90deg, rgba(79, 70, 229, 0.1), transparent);
            border-left-color: var(--accent);
            color: var(--accent);
        }

        .nav-item:hover::before, .nav-item.active::before {
            opacity: 1;
        }

        .control-buttons {
            padding: 20px;
            border-top: 1px solid var(--border);
        }

        .control-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 10px;
            padding: 10px 14px;
            background: var(--clash-blue);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            transition: var(--transition);
        }

        .control-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .control-btn.secondary {
            background: var(--clash-gold);
        }

        .main-content {
            margin-left: 300px;
            flex: 1;
            background: #f8fafc;
            min-height: 100vh;
        }

        .page-section {
            margin: 0;
            padding: 40px;
            background: var(--secondary);
            border-bottom: 1px solid var(--border);
            min-height: 100vh;
            page-break-after: always;
        }

        .cover-page {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #f59e0b 100%);
            color: white;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .cover-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 16px;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .cover-subtitle {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        .cover-version {
            font-size: 16px;
            margin-bottom: 32px;
            opacity: 0.8;
        }

        .logo-container {
            display: flex;
            gap: 60px;
            margin: 40px 0;
            align-items: center;
        }

        .logo-item {
            text-align: center;
        }

        .logo-item img {
            height: 80px;
            width: auto;
            margin-bottom: 12px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--clash-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .page-subtitle {
            font-size: 16px;
            color: var(--text-muted);
            margin-bottom: 32px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
            background: var(--secondary);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            font-size: 13px;
        }

        .data-table th {
            background: var(--youtube-red);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
            border: 1px solid #cc0000;
        }

        .data-table.naver th {
            background: var(--naver-green);
            border-color: #00a832;
        }

        .data-table td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid var(--border);
            font-size: 12px;
        }

        .data-table tr:nth-child(even) {
            background: #f9fafb;
        }

        .data-table .positive {
            color: var(--success);
            font-weight: 700;
        }

        .data-table .negative {
            color: var(--error);
            font-weight: 700;
        }

        .chart-container {
            background: var(--secondary);
            border-radius: var(--radius);
            padding: 24px;
            margin: 24px 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 24px 0;
        }

        .video-card {
            background: var(--secondary);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: var(--transition);
        }

        .video-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .video-thumbnail {
            width: 100%;
            height: 160px;
            object-fit: cover;
        }

        .video-info {
            padding: 16px;
        }

        .video-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .video-stats {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .video-link {
            display: inline-block;
            padding: 6px 12px;
            background: var(--youtube-red);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            transition: var(--transition);
        }

        .video-link:hover {
            background: #cc0000;
        }

        .insights-panel {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: var(--radius);
            padding: 24px;
            margin: 24px 0;
            border-left: 4px solid var(--info);
        }

        .insights-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 16px;
        }

        .insight-item {
            background: white;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 12px;
            border-left: 3px solid var(--info);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            cursor: text; /* Make it look editable */
        }

        .insight-item:empty:before {
            content: "í´ë¦­í•˜ì—¬ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...";
            color: #aaa;
        }

        .insight-item.positive {
            border-left-color: var(--success);
        }

        .insight-item.negative {
            border-left-color: var(--error);
        }

        .insight-item.warning {
            border-left-color: var(--warning);
        }

        .age-distribution {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .age-card {
            background: var(--secondary);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .age-card h4 {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .age-card .value {
            font-size: 24px;
            font-weight: 700;
            color: var(--clash-blue);
            margin-bottom: 4px;
        }

        .age-card .change {
            font-size: 12px;
            font-weight: 600;
        }

        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .admin-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .admin-panel {
            background: var(--secondary);
            border-radius: 12px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateY(20px);
            transition: var(--transition);
        }

        .admin-modal.active .admin-panel {
            transform: translateY(0);
        }

        .admin-header {
            background: var(--clash-blue);
            color: white;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .admin-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .admin-content {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--primary);
            font-size: 14px;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            color: var(--text);
            background: var(--secondary);
            transition: var(--transition);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
            outline: none;
        }

        .file-upload-zone {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            background: var(--hover);
            transition: var(--transition);
            margin: 16px 0;
        }

        .file-upload-zone:hover, .file-upload-zone.dragover {
            border-color: var(--accent);
            background: rgba(79, 70, 229, 0.05);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: var(--text);
            padding: 12px 16px;
            border-radius: 6px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 10001;
            max-width: 350px;
            font-size: 14px;
        }

        .notification.show {
            opacity: 1;
            visibility: visible;
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--error);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        .notification.info {
            border-left: 4px solid var(--info);
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .page-section {
                padding: 24px 16px;
            }
            
            .cover-title {
                font-size: 32px;
            }
            
            .logo-container {
                flex-direction: column;
                gap: 30px;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
            }
        }

        .sample-data-section {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: var(--radius);
            padding: 16px;
            margin: 16px 0;
        }

        .sample-data-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sample-btn {
            padding: 8px 12px;
            background: var(--info);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: var(--transition);
        }

        .sample-btn:hover {
            background: #0284c7;
        }

        .custom-content-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }

        .custom-content-controls button {
            background: var(--accent);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: background 0.2s ease;
        }

        .custom-content-controls button:hover {
            background: #3e38b2;
        }

        .editable-content-wrapper {
            margin-bottom: 20px;
            border: 1px dashed var(--border);
            padding: 15px;
            border-radius: var(--radius);
            background: #fdfdfd;
        }

        .editable-content-wrapper .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
        }

        .editable-content-wrapper .content-header button {
            background: none;
            border: none;
            color: var(--error);
            font-size: 18px;
            cursor: pointer;
        }

        .editable-text-block {
            min-height: 50px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            background: #fff;
            margin-top: 10px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .editable-text-block:focus {
            border-color: var(--accent);
        }

        .editable-image-block {
            text-align: center;
            margin-top: 10px;
        }

        .editable-image-block img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            border: 1px solid #eee;
            margin-bottom: 10px;
        }

        .editable-image-block input[type="text"] {
            width: calc(100% - 20px);
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }

        .ai-issue-button {
            margin-top: 20px;
            background: var(--info);
        }
    </style>
</head>
<body>
    <!-- ê´€ë¦¬ì íŒ¨ë„ -->
    <div class="admin-modal" id="adminModal">
        <div class="admin-panel">
            <div class="admin-header">
                <h2>ğŸ“Š ë°ì´í„° ê´€ë¦¬ íŒ¨ë„</h2>
                <button class="admin-close" onclick="closeAdminPanel()">&times;</button>
            </div>
            
            <div class="admin-content">
                <div class="sample-data-section">
                    <h4>ğŸ¯ ì‹¤ì œ Excel íŒŒì¼ ì—…ë¡œë“œ (ê¶Œì¥)</h4>
                    <p style="font-size: 12px; color: var(--text-muted); margin: 8px 0;">
                        <strong>í•„ìˆ˜ ì‹œíŠ¸:</strong> 'Naver Cafe', 'Youtube', 'Youtube(ALL)', 'Youtube community'<br>
                        Excel íŒŒì¼ì´ë©´ ìë™ìœ¼ë¡œ ëª¨ë“  ì‹œíŠ¸ë¥¼ ì¸ì‹í•˜ê³  ê³„ì‚°í•©ë‹ˆë‹¤.
                    </p>
                    <div style="background: #f0f9ff; padding: 12px; border-radius: 6px; margin: 8px 0; font-size: 12px;">
                        <div style="font-weight: 600; margin-bottom: 4px;">âœ… ìë™ ì²˜ë¦¬ ê¸°ëŠ¥:</div>
                        <div>â€¢ ê° ì‹œíŠ¸ë³„ ë°ì´í„° í’ˆì§ˆ ìë™ ê²€ì¦</div>
                        <div>â€¢ í•©ê³„, í‰ê· , ì„±ì¥ë¥  ìë™ ê³„ì‚°</div>
                        <div>â€¢ ëˆ„ë½ëœ í•„ë“œ ìë™ ê°ì§€ ë° ì•Œë¦¼</div>
                        <div>â€¢ AIê°€ ì„ì˜ë¡œ ë°ì´í„° ìƒì„±í•˜ì§€ ì•ŠìŒ</div>
                    </div>
                </div>

                <div class="sample-data-section" style="background: #fff8dc; border-color: var(--warning);">
                    <h4>ğŸ“‹ CSV ìƒ˜í”Œ ë‹¤ìš´ë¡œë“œ (ì°¸ê³ ìš©)</h4>
                    <p style="font-size: 12px; color: var(--text-muted); margin: 8px 0;">Excel íŒŒì¼ í˜•ì‹ ì°¸ê³ ìš©</p>
                    <div class="sample-data-buttons">
                        <button class="sample-btn" onclick="downloadSample('youtube-total')">YouTube ì›”ë³„</button>
                        <button class="sample-btn" onclick="downloadSample('youtube-detail')">YouTube ì˜ìƒë³„</button>
                        <button class="sample-btn" onclick="downloadSample('naver-cafe')">Naver Cafe</button>
                        <button class="sample-btn" onclick="downloadSample('dau')">DAU</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ğŸ“ íŒŒì¼ ì—…ë¡œë“œ</label>
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;">
                        <strong>Excel íŒŒì¼ (.xlsx)</strong>: ëª¨ë“  ì‹œíŠ¸ ìë™ ì¸ì‹ ë° ì²˜ë¦¬ <span style="color: var(--success);">âœ¨ ê¶Œì¥</span><br>
                        <strong>CSV íŒŒì¼ (.csv)</strong>: ë‹¨ì¼ ë°ì´í„° ìœ í˜•ë§Œ ì²˜ë¦¬
                    </div>
                </div>

                <div class="form-group" id="csvDataTypeGroup" style="display: none;">
                    <label class="form-label">CSV ë°ì´í„° ìœ í˜•</label>
                    <select class="form-select" id="dataTypeSelector" onchange="updateUploadInfo()">
                        <option value="">CSV ë°ì´í„° ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="youtube-total">YouTube 3ê°œì›” ì¢…í•© ë°ì´í„°</option>
                        <option value="youtube-detail">YouTube ì˜ìƒë³„ ìƒì„¸ ë°ì´í„°</option>
                        <option value="naver-cafe">Naver Cafe 3ê°œì›” ë°ì´í„°</option>
                        <option value="dau">DAU (Daily Active Users) ë°ì´í„°</option>
                    </select>
                </div>

                <div class="file-upload-zone" id="fileUploadZone">
                    <div style="font-size: 28px; margin-bottom: 8px;">ğŸ“Š</div>
                    <div style="font-size: 16px; margin-bottom: 8px; font-weight: 600;">Excel ë˜ëŠ” CSV íŒŒì¼ ì—…ë¡œë“œ</div>
                    <div style="font-size: 13px; color: var(--text-muted);">
                        Excel íŒŒì¼: ëª¨ë“  ì‹œíŠ¸ ìë™ ì¸ì‹<br>
                        CSV íŒŒì¼: ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë˜ëŠ” í´ë¦­
                    </div>
                    <input type="file" accept=".xlsx,.xls,.csv" style="display: none;">
                </div>

                <div id="dataQualityInfo" style="display: none; margin: 16px 0;">
                    <div style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">ë°ì´í„° í’ˆì§ˆ ë¶„ì„</div>
                    <div style="background: #e5e7eb; height: 8px; border-radius: 4px; overflow: hidden;">
                        <div id="qualityBar" style="background: var(--success); height: 100%; width: 0%; transition: width 0.3s ease;"></div>
                    </div>
                    <div id="qualityText" style="font-size: 12px; margin-top: 4px; color: var(--text-muted);">í’ˆì§ˆ ì ìˆ˜: 0%</div>
                </div>

                <div id="excelAnalysisResult"></div> <!-- Excel ë¶„ì„ ê²°ê³¼ í‘œì‹œ ì˜ì—­ -->

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="control-btn" onclick="processUploadedData()">ğŸ“Š ë°ì´í„° ì ìš©</button>
                    <button class="control-btn secondary" onclick="generateReport()">ğŸ“„ ë¦¬í¬íŠ¸ ìƒì„±</button>
                </div>

                <div class="custom-content-controls">
                    <button onclick="openAddCustomContentModal()">â• ì»¤ìŠ¤í…€ ì½˜í…ì¸  ì¶”ê°€</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì»¤ìŠ¤í…€ ì½˜í…ì¸  ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="admin-modal" id="addCustomContentModal">
        <div class="admin-panel">
            <div class="admin-header">
                <h2>â• ì»¤ìŠ¤í…€ ì½˜í…ì¸  ì¶”ê°€</h2>
                <button class="admin-close" onclick="closeAddCustomContentModal()">&times;</button>
            </div>
            <div class="admin-content">
                <div class="form-group">
                    <label class="form-label">ì½˜í…ì¸ ë¥¼ ì¶”ê°€í•  ì„¹ì…˜ ì„ íƒ</label>
                    <select class="form-select" id="contentSectionSelector">
                        <option value="youtube-total">ğŸ“º YouTube ì¢…í•©</option>
                        <option value="youtube-charts">ğŸ“Š YouTube ì°¨íŠ¸</option>
                        <option value="youtube-detail">ğŸ¬ YouTube ìƒì„¸</option>
                        <option value="naver-total">ğŸ’¬ Naver Cafe ì¢…í•©</option>
                        <option value="naver-charts">ğŸ“ˆ Naver Cafe ì°¨íŠ¸</option>
                        <option value="youtube-community">ğŸ“± YouTube ì»¤ë®¤ë‹ˆí‹°</option>
                        <option value="age-analysis">ğŸ‘¥ ì—°ë ¹ì¸µ ë¶„ì„</option>
                        <option value="key-issues">ğŸ”‘ ì£¼ìš” ì´ìŠˆ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ì½˜í…ì¸  ìœ í˜•</label>
                    <select class="form-select" id="contentTypeSelector">
                        <option value="text">í…ìŠ¤íŠ¸ ë¸”ë¡</option>
                        <option value="image">ì´ë¯¸ì§€ ë¸”ë¡</option>
                    </select>
                </div>
                <div id="textInputGroup" class="form-group">
                    <label class="form-label">í…ìŠ¤íŠ¸ ë‚´ìš©</label>
                    <textarea class="form-textarea" id="customContentText" rows="5" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”."></textarea>
                </div>
                <div id="imageInputGroup" class="form-group" style="display: none;">
                    <label class="form-label">ì´ë¯¸ì§€ URL</label>
                    <input type="text" class="form-input" id="customContentImageUrl" placeholder="ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”.">
                    <label class="form-label" style="margin-top: 10px;">ì´ë¯¸ì§€ ì„¤ëª… (alt text)</label>
                    <input type="text" class="form-input" id="customContentImageAlt" placeholder="ì´ë¯¸ì§€ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.">
                </div>
                <button class="control-btn" onclick="addCustomContent()">ì½˜í…ì¸  ì¶”ê°€</button>
            </div>
        </div>
    </div>


    <div class="container">
        <!-- ì‚¬ì´ë“œë°” -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1>ì›”ê°„ ì»¤ë®¤ë‹ˆí‹° ë¦¬ë·°</h1>
                <div class="subtitle">Clash Royale</div>
                <div class="period-selector">
                    <select id="yearSelector"></select>
                    <select id="monthSelector"></select>
                </div>
                <div class="current-period" id="currentPeriod">2025ë…„ 6ì›”</div>
            </div>
            
            <div class="nav-menu">
                <div class="nav-section">ğŸ“‹ ë¦¬í¬íŠ¸ ì„¹ì…˜</div>
                <a href="#cover" class="nav-item active">ğŸ“‘ í‘œì§€</a>
                <a href="#youtube-total" class="nav-item">ğŸ“º YouTube ì¢…í•©</a>
                <a href="#youtube-charts" class="nav-item">ğŸ“Š YouTube ì°¨íŠ¸</a>
                <a href="#youtube-detail" class="nav-item">ğŸ¬ YouTube ìƒì„¸</a>
                <a href="#naver-total" class="nav-item">ğŸ’¬ Naver Cafe ì¢…í•©</a>
                <a href="#naver-charts" class="nav-item">ğŸ“ˆ Naver Cafe ì°¨íŠ¸</a>
                <a href="#youtube-community" class="nav-item">ğŸ“± YouTube ì»¤ë®¤ë‹ˆí‹°</a>
                <a href="#age-analysis" class="nav-item">ğŸ‘¥ ì—°ë ¹ì¸µ ë¶„ì„</a>
                <a href="#key-issues" class="nav-item">ğŸ”‘ ì£¼ìš” ì´ìŠˆ</a>
            </div>
            
            <div class="control-buttons">
                <button class="control-btn" onclick="openAdminPanel()">ğŸ“Š ë°ì´í„° ê´€ë¦¬</button>
                <button class="control-btn secondary" onclick="exportToPDF()">ğŸ“¥ PDF ë‚´ë³´ë‚´ê¸°</button>
            </div>
        </nav>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <!-- í‘œì§€ -->
            <section id="cover" class="page-section cover-page">
                <div class="cover-title" contenteditable="true">Monthly Community Review</div>
                <div class="cover-subtitle" contenteditable="true">- Clash Royale</div>
                <div class="cover-version" contenteditable="true">Ver 1.0 <span id="reportDate">2025.07.17</span></div>
                
                <div class="logo-container">
                    <div class="logo-item">
                        <img src="https://i.imgur.com/N2gxrkh.png" alt="Clash Royale" onerror="this.style.display='none'">
                        <div style="margin-top: 8px; font-size: 14px;" contenteditable="true">Clash Royale</div>
                    </div>
                    <div class="logo-item">
                        <img src="https://i.imgur.com/geVZCaY.png" alt="PRABBIT" onerror="this.style.display='none'">
                        <div style="margin-top: 8px; font-size: 14px;" contenteditable="true">PRABBIT</div>
                    </div>
                </div>

                <div style="margin-bottom: 20px; font-size: 14px; opacity: 0.8;" contenteditable="true">
                    Community Marketing Team
                </div>
            </section>

            <!-- YouTube ì¢…í•© ë°ì´í„° -->
            <section id="youtube-total" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ“º í´ë˜ì‹œ ë¡œì–„ ì±„ë„ë³„ ë°ì´í„° (6ì›” ì—…ë¡œë“œ ì½˜í…ì¸ )</h2>
                <p class="page-subtitle" contenteditable="true">YouTube 3-month Total Data</p>

                <table class="data-table" id="youtubeMainTable">
                    <thead>
                        <tr>
                            <th rowspan="2">Status</th>
                            <th rowspan="2">Subscriber</th>
                            <th colspan="3">Videos</th>
                            <th colspan="3">Likes</th>
                            <th colspan="3">Community</th>
                        </tr>
                        <tr>
                            <th>Total</th>
                            <th>VOD Views</th>
                            <th>Shorts Views</th>
                            <th>Total</th>
                            <th>VOD Likes</th>
                            <th>Shorts Likes</th>
                            <th>Views</th>
                            <th>Likes</th>
                            <th>Counts</th>
                        </tr>
                    </thead>
                    <tbody id="youtubeMainTableBody">
                        <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                    </tbody>
                    <tfoot>
                        <tr>
                            <td style="background: var(--youtube-red); color: white; font-weight: 700;">ì „ì›” ëŒ€ë¹„ ì¦ê°ìœ¨(%)</td>
                            <td style="background: var(--youtube-red); color: white;">-</td>
                            <td style="background: var(--youtube-red); color: white;" class="positive">41.66%â–²</td>
                            <td style="background: var(--youtube-red); color: white;" class="negative">25.36%â–¼</td>
                            <td style="background: var(--youtube-red); color: white;" class="positive">92.56%â–²</td>
                            <td style="background: var(--youtube-red); color: white;" class="positive">26.50%â–²</td>
                            <td style="background: var(--youtube-red); color: white;" class="negative">61.26%â–¼</td>
                            <td style="background: var(--youtube-red); color: white;" class="positive">84.25%â–²</td>
                            <td style="background: var(--youtube-red); color: white;" class="negative">30.90%â–¼</td>
                            <td style="background: var(--youtube-red); color: white;" class="negative">3.59%â–¼</td>
                            <td style="background: var(--youtube-red); color: white;" class="negative">37.50%â–¼</td>
                        </tr>
                    </tfoot>
                </table>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ“Š ë¶„ì„ ì¸ì‚¬ì´íŠ¸</div>
                    <div class="insight-item positive" contenteditable="true">
                        <p>ì»¤ë®¤ë‹ˆí‹° ìˆ˜ì¹˜ì˜ í•˜ë½ì€ ê²Œì‹œë¬¼ ì—…ë¡œë“œ ìˆ˜ì˜ í•˜ë½ ë•Œë¬¸ìœ¼ë¡œ, í‰ê·  ìˆ˜ì¹˜ëŠ” ì¢‹ì•„ìš” 10% ì¦ê°€ / ì¢‹ì•„ìš” ìˆ˜ 54% ì¦ê°€ / ëŒ“ê¸€ ìˆ˜ 118% ì¦ê°€í•˜ì˜€ìŒ.</p>
                    </div>
                </div>

                <div id="youtube-total-custom-content"></div>
                <div id="youtube-calculated-metrics"></div>
            </section>

            <!-- YouTube ì°¨íŠ¸ -->
            <section id="youtube-charts" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ“Š í´ë˜ì‹œ ë¡œì–„ ì±„ë„ë³„ ë°ì´í„° (6ì›” ì—…ë¡œë“œ ì½˜í…ì¸ )</h2>
                <p class="page-subtitle" contenteditable="true">YouTube 3-month Table & Graph</p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                    <div class="chart-container">
                        <div class="chart-title">ì´ ì¡°íšŒìˆ˜ & ì´ ì¢‹ì•„ìš” ìˆ˜</div>
                        <div class="chart-wrapper">
                            <canvas id="youtubeViewsChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">ì—…ë¡œë“œ ì˜ìƒ ìˆ˜ & ì‡¼ì¸  ìˆ˜</div>
                        <div class="chart-wrapper">
                            <canvas id="youtubeUploadsChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ“ˆ ì°¨íŠ¸ ë¶„ì„</div>
                    <div class="insight-item" contenteditable="true">
                        <p>ì˜ìƒ ì—…ë¡œë“œ ìˆ˜ëŠ” ì¤„ì–´ë“¤ì—ˆì§€ë§Œ í‰ê·  ì¡°íšŒìˆ˜ê°€ ìƒìŠ¹í•¨ì— ë”°ë¼ ì „ì²´ ì¡°íšŒìˆ˜ê°€ 41% ìƒìŠ¹í•˜ì˜€ìŒ.</p>
                    </div>
                    <div class="insight-item positive" contenteditable="true">
                        <p>ë˜í•œ, ì‹ ê·œ ì˜ìƒë“¤ì˜ êµ­ë‚´ ì‹œì²­ì ë„ë‹¬ë¥ ì´ 90% ì¤‘í›„ë°˜ëŒ€ë¡œ ì†Œí­ ìƒìŠ¹í•˜ì—¬ ìœ ì§€ë˜ê³  ìˆìŒ.</p>
                    </div>
                </div>

                <div id="youtube-charts-custom-content"></div>
            </section>

            <!-- YouTube ìƒì„¸ ë°ì´í„° -->
            <section id="youtube-detail" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ¬ í´ë˜ì‹œ ë¡œì–„ ì½˜í…ì¸  ë°ì´í„°</h2>
                <p class="page-subtitle" contenteditable="true">Top 3 Featured Content</p>

                <div class="video-grid" id="topVideosGrid">
                    <!-- ìƒìœ„ 3ê°œ ì˜ìƒì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ¯ ì½˜í…ì¸  ì„±ê³¼ ë¶„ì„</div>
                    <div class="insight-item positive" contenteditable="true">
                        <p>VOD í‰ê·  ì¡°íšŒìˆ˜ (22,167íšŒ â†’ 41,291íšŒ), Shorts í‰ê·  ì¡°íšŒìˆ˜ (24,312íšŒ â†’ 35,112íšŒ)ë¡œ ìƒìŠ¹í•¨.</p>
                    </div>
                    <div class="insight-item" contenteditable="true">
                        <p>íŠ¹íˆ, VODì˜ ê²½ìš° ì—…ë¡œë“œ ì˜ìƒ ìˆ˜ëŠ” ì¤„ì—ˆì§€ë§Œ TV ë¡œì–„ ì˜ìƒì´ 7ë§Œ íšŒì˜ ì¡°íšŒìˆ˜ë¥¼ ê¸°ë¡í•˜ë©° í‰ê·  ì¡°íšŒìˆ˜ê°€ í¬ê²Œ ìƒìŠ¹í•¨.</p>
                    </div>
                </div>

                <div id="youtube-detail-custom-content"></div>
                <div id="youtube-detail-calculated-metrics"></div>
            </section>

            <!-- Naver Cafe ì¢…í•© -->
            <section id="naver-total" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ’¬ í´ë˜ì‹œ ë¡œì–„ ì±„ë„ë³„ ë°ì´í„°</h2>
                <p class="page-subtitle" contenteditable="true">Naver Cafe 3-month total</p>

                <table class="data-table naver" id="naverMainTable">
                    <thead>
                        <tr>
                            <th rowspan="2">Status</th>
                            <th rowspan="2">Join<br>(íšŒì›ê°€ì…)</th>
                            <th colspan="2">Contents (ê²Œì‹œë¬¼ ë¶„ì„)</th>
                            <th colspan="4">Visitor (ë°©ë¬¸ ë¶„ì„)</th>
                        </tr>
                        <tr>
                            <th>ì‘ì„± ê²Œì‹œê¸€ ìˆ˜</th>
                            <th>ì´ ì¡°íšŒìˆ˜</th>
                            <th>ëŒ“ê¸€ ìˆ˜</th>
                            <th>ìˆœë°©ë¬¸ì ìˆ˜</th>
                            <th>í‰ê·  ë°©ë¬¸íšŸìˆ˜</th>
                            <th>í‰ê·  ì‚¬ìš©ì‹œê°„</th>
                            <th>ì¬ë°©ë¬¸ìœ¨</th>
                        </tr>
                    </thead>
                    <tbody id="naverMainTableBody">
                        <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ“Š ë¶„ì„ ì¸ì‚¬ì´íŠ¸</div>
                    <div class="insight-item positive" contenteditable="true">
                        <p>ì§€ì†ì ì¸ ì„±ì¥ì€ í¬ë¦¬ì—ì´í„°ì˜ ì„±ì¥ì— ë§ì€ ì˜í–¥ì„ ë°›ì€ ê²ƒìœ¼ë¡œ ë³´ì´ë©° (Youtube ë° ì™¸ë¶€ ì‚¬ì´íŠ¸ ìœ ì… â†‘), ì¹´í˜ ë‚´ í¬ë¦¬ì—ì´í„° ì–¸ê¸‰ëŸ‰ì´ ìƒìŠ¹í•¨(íŠ¹íˆ í˜¸ì™•)</p>
                    </div>
                </div>

                <div id="naver-total-custom-content"></div>
                <div id="naver-calculated-metrics"></div>
            </section>

            <!-- Naver Cafe ì°¨íŠ¸ -->
            <section id="naver-charts" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ“ˆ í´ë˜ì‹œ ë¡œì–„ ì±„ë„ë³„ ë°ì´í„°</h2>
                <p class="page-subtitle" contenteditable="true">Naver Cafe 3-month Table & Graph</p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin: 30px 0;">
                    <div class="chart-container">
                        <div class="chart-title">ì´ ì¡°íšŒìˆ˜ & ìˆœ ë°©ë¬¸ì ìˆ˜</div>
                        <div class="chart-wrapper">
                            <canvas id="naverVisitorsChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">ê²Œì‹œê¸€ ìˆ˜ & ëŒ“ê¸€ ìˆ˜</div>
                        <div class="chart-wrapper">
                            <canvas id="naverPostsChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ“ˆ ì°¨íŠ¸ ë¶„ì„</div>
                    <div class="insight-item" contenteditable="true">
                        <p>ìˆœ ë°©ë¬¸ì ìˆ˜ëŠ” ë‹¤ì†Œ ê°ì†Œí–ˆìœ¼ë‚˜ ê²Œì‹œê¸€ ìˆ˜(18.1%â–²)ì™€ ëŒ“ê¸€ ìˆ˜(27.7%â–²)ê°€ í¬ê²Œ ëŠ˜ì–´ë‚˜ë©° ê¸°ì¡´ ìœ ì €ë“¤ì˜ ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬ê°€ í™œë°œí•´ì§.</p>
                    </div>
                    <div class="insight-item positive" contenteditable="true">
                        <p>ë˜í•œ, 10ëŒ€(9.6%â–²)ì™€ 20ëŒ€(10.9%â–²)ì˜ ì¡°íšŒìˆ˜ê°€ í° í­ìœ¼ë¡œ ìƒìŠ¹í•˜ë©° ê¸°ì¡´ë³´ë‹¤ ì–´ë¦° ì—°ë ¹ëŒ€ë¡œ ì£¼ìš” í™œë™ì¸µì´ ë³€í™”í•˜ëŠ” ì–‘ìƒì„ ë³´ì„.</p>
                    </div>
                </div>

                <div id="naver-charts-custom-content"></div>
            </section>

            <!-- YouTube ì»¤ë®¤ë‹ˆí‹° ë°ì´í„° ì¶”ê°€ -->
            <section id="youtube-community" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ“± YouTube ì»¤ë®¤ë‹ˆí‹°</h2>
                <p class="page-subtitle" contenteditable="true">YouTube ì»¤ë®¤ë‹ˆí‹° íƒ­ í™œë™ í†µê³„</p>
                
                <table class="data-table" id="youtubeCommunityTable">
                    <thead>
                        <tr><th>í•­ëª©</th><th>4ì›”</th><th>5ì›”</th><th>6ì›”</th><th>ì´ê³„</th></tr>
                    </thead>
                    <tbody></tbody>
                </table>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ“Š ë¶„ì„ ì¸ì‚¬ì´íŠ¸</div>
                    <div class="insight-item" contenteditable="true">
                        <p>YouTube ì»¤ë®¤ë‹ˆí‹° íƒ­ì˜ í™œë™ì€ ì „ë°˜ì ìœ¼ë¡œ ì•ˆì •ì ì¸ ì°¸ì—¬ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ê²Œì‹œë¬¼ ìˆ˜ì™€ ì¢‹ì•„ìš” ìˆ˜ê°€ ê¾¸ì¤€íˆ ìœ ì§€ë˜ê³  ìˆìœ¼ë©°, ëŒ“ê¸€ ì°¸ì—¬ë„ í™œë°œí•©ë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div id="youtube-community-custom-content"></div>
                <div id="youtube-community-calculated-metrics"></div>
            </section>

            <section id="age-analysis" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ‘¥ í´ë˜ì‹œ ë¡œì–„ í”Œë«í¼ë³„ ì£¼ ì—°ë ¹ì¸µ</h2>
                <p class="page-subtitle" contenteditable="true">Clash Royale Main age groups by platform</p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 30px 0;">
                    <div class="chart-container">
                        <div class="chart-title">í”Œë«í¼ë³„ ì—°ë ¹ëŒ€ ë¹„êµ</div>
                        <div class="chart-wrapper">
                            <canvas id="ageComparisonChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">ì›”ë³„ ì—°ë ¹ëŒ€ ë³€í™” (ë„¤ì´ë²„ ì¹´í˜)</div>
                        <div class="chart-wrapper">
                            <canvas id="ageMonthlyChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="age-distribution">
                    <div class="age-card">
                        <h4>10ëŒ€</h4>
                        <div class="value" contenteditable="true">196,418</div>
                        <div class="change positive" contenteditable="true">+9.6%</div>
                    </div>
                    <div class="age-card">
                        <h4>20ëŒ€</h4>
                        <div class="value" contenteditable="true">153,453</div>
                        <div class="change positive" contenteditable="true">+10.9%</div>
                    </div>
                    <div class="age-card">
                        <h4>30ëŒ€</h4>
                        <div class="value" contenteditable="true">57,974</div>
                        <div class="change negative" contenteditable="true">-14.2%</div>
                    </div>
                    <div class="age-card">
                        <h4>40ëŒ€ ì´ìƒ</h4>
                        <div class="value" contenteditable="true">85,007</div>
                        <div class="change neutral" contenteditable="true">-0.5%</div>
                    </div>
                </div>

                <div class="insights-panel">
                    <div class="insights-title">ğŸ“Š ì—°ë ¹ì¸µ ë¶„ì„</div>
                    <div class="insight-item" contenteditable="true">
                        <p>ë„¤ì´ë²„ ì¹´í˜ ì´ìš©ìì˜ ì•½ 38%ê°€ 10ëŒ€ ì´ˆë°˜-í›„ë°˜ì— ì§‘ì¤‘ë˜ì–´ ìˆìœ¼ë©°, ìœ íŠœë¸ŒëŠ” 10ëŒ€ í›„ë°˜(30%) - 30ëŒ€ ì´ˆë°˜(22%) ì´ìš©ì ë¹„ì¤‘ì´ ì ˆë°˜ ì´ìƒì„ ì°¨ì§€í•˜ê³  ìˆìŒ.</p>
                    </div>
                    <div class="insight-item positive" contenteditable="true">
                        <p>ë„¤ì´ë²„ ì¹´í˜ëŠ” 24ë…„ í›„ë°˜ ~ 25ë…„ ì´ˆë°˜ê¹Œì§€ 10ëŒ€ í›„ë°˜ - 20ëŒ€ ì´ˆë°˜ ìœ„ì£¼ë¡œ ì»¤ë®¤ë‹ˆí‹°ê°€ í˜•ì„±ë˜ì–´ ìˆì—ˆìœ¼ë‚˜, ìµœê·¼ 10ëŒ€ì˜ ë¹„ì¤‘ì´ ì§€ì†ì ìœ¼ë¡œ ìƒìŠ¹í•˜ê³  ìˆìŒ.</p>
                    </div>
                    <div class="insight-item" contenteditable="true">
                        <p>ìœ íŠœë¸ŒëŠ” 35ì„¸~44ì„¸ë¡œ ë‹¤ì†Œ ë†’ì€ ì´ìš©ì ì—°ë ¹ëŒ€ë¥¼ ë³´ì˜€ìœ¼ë‚˜, ìµœê·¼ì—ëŠ” ë†’ì€ ì—°ë ¹ëŒ€ ë¹„ì¤‘ì´ í¬ê²Œ ì¤„ê³  20ëŒ€ ì´ˆë°˜ ì´ìš©ìê°€ ë¹ ë¥´ê²Œ ì¦ê°€í•˜ëŠ” ì¶”ì„¸ì„</p>
                    </div>
                </div>

                <div id="age-analysis-custom-content"></div>
            </section>

            <!-- ì£¼ìš” ì´ìŠˆ -->
            <section id="key-issues" class="page-section">
                <h2 class="page-title" contenteditable="true">ğŸ”‘ í´ë˜ì‹œ ë¡œì–„ Key issues</h2>
                <p class="page-subtitle" contenteditable="true">Updated Contents (Positives & Negatives)</p>

                <div style="text-align: center; margin-bottom: 20px;">
                    <button class="control-btn ai-issue-button" onclick="generateAIKeyIssues()">âœ¨ AIê°€ ì£¼ìš” ì´ìŠˆ ìƒì„±</button>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 30px 0;">
                    <div class="insights-panel">
                        <div class="insights-title">ğŸ‘ Positives</div>
                        <div class="insight-item positive" contenteditable="true">
                            <p>ìµœê·¼ ì¶œì‹œë˜ì—ˆë˜ ë‹¤ë¥¸ ì§„í™” ì¹´ë“œì™€ëŠ” ë‹¬ë¦¬, ëª…í™•í•œ ì¥ë‹¨ì  ë•ë¶„ì— ì¤€ìˆ˜í•œ ì„±ëŠ¥+íƒ€ ì§„í™” ì¹´ë“œë“¤ì˜ ì´ˆê¸° ì„±ëŠ¥ê³¼ ë¹„êµí–ˆì„ ë•Œ ì–‘í˜¸í•œ ë°¸ëŸ°ìŠ¤ë¡œ ì¶œì‹œëœ ê²ƒ ê°™ë‹¤ëŠ” í‰ê°€</p>
                        </div>
                        <div class="insight-item positive" contenteditable="true">
                            <p>í•„ìš” ì—˜ë¦­ì„œì— ë¹„í•´ ëŠ¥ë ¥ì˜ ê°€ì¹˜(ë°ë¯¸ì§€)ê°€ íš¨ìœ¨ì´ ì¢‹ë‹¤ëŠ” í‰ê°€</p>
                        </div>
                        <div class="insight-item positive" contenteditable="true">
                            <p>ìœ ì‚¬ ì¥ë¥´ì¸ ì „ëµì  íŒ€ ì „íˆ¬(TFT)ì— ë¹„í•´ í”Œë ˆì´ ì‹œê°„ì´ ì§§ê³  ê·œì¹™ì´ ë‹¨ìˆœí•´ì„œ ì¢‹ë‹¤ëŠ” í‰ê°€</p>
                        </div>
                        <div id="key-issues-positives-custom-content"></div>
                    </div>

                    <div class="insights-panel">
                        <div class="insights-title">ğŸ‘ Negatives</div>
                        <div class="insight-item negative" contenteditable="true">
                            <p>ì¹´ìš´í„°ê°€ ë„ˆë¬´ ëª…í™•í•œ ì¹´ë“œ ì¤‘ í•˜ë‚˜ë¼ í™œìš©ì´ í•œì •ì ì´ë¼ëŠ” í‰ê°€</p>
                        </div>
                        <div class="insight-item negative" contenteditable="true">
                            <p>4ì—˜ë¦­ì„œì— 2íšŒì˜ ìˆœí™˜ ì£¼ê¸°ë¼ëŠ” ì  ë•Œë¬¸ì— ëŠ¥ë ¥ì„ ì œëŒ€ë¡œ í™œìš©í•˜ê¸° ì „ì— ê²Œì„ì´ ëë‚˜ë²„ë¦°ë‹¤ëŠ” ì˜ê²¬</p>
                        </div>
                        <div class="insight-item negative" contenteditable="true">
                            <p>ê°€ì¥ í•µì‹¬ì ìœ¼ë¡œ, ë³¸ ê²Œì„ì˜ ì¹´ë“œ ë ˆë²¨ì´ í•©ì²´ ì „ìˆ ì—ë„ ì ìš©ë˜ë©´ì„œ ê¸°ì¡´ í•„ìš”í•œ ì¹´ë“œë§Œ ë ˆë²¨ì„ ì˜¬ë ¤ë‘ì—ˆë˜ ìœ ì €ë“¤ì€ ìì‹ ì˜ ì „ëµê³¼ëŠ” ìƒê´€ ì—†ì´ ë¶ˆë¦¬í•œ ìœ„ì¹˜ì—ì„œ í”Œë ˆì´í•˜ê²Œ ë˜ì—ˆìŒ.</p>
                        </div>
                        <div id="key-issues-negatives-custom-content"></div>
                    </div>
                </div>
                <div id="key-issues-custom-content"></div>

                <div style="text-align: center; margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--border);">
                    <h2 style="font-size: 48px; font-weight: 300; color: var(--text-muted); margin-bottom: 20px;" contenteditable="true">E.O.D</h2>
                    <p style="color: var(--text-muted); font-size: 14px;" contenteditable="true">
                        <span id="endDate">2025.07.17</span><br>
                        All rights reserved. PRABBIT. 2025
                    </p>
                </div>
            </section>
        </main>
    </div>

    <!-- ì•Œë¦¼ í‘œì‹œ ì˜ì—­ -->
    <div class="notification" id="notification"></div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let uploadedData = {};
        let chartInstances = {};
        let currentReportDate = new Date();
        let excelProcessor; // Declare globally

        // ìƒ˜í”Œ ë°ì´í„° ì •ì˜
        const sampleDataTemplates = {
            'youtube-total': {
                headers: ['Status', 'Subscriber', 'Videos', 'VOD Views', 'Shorts Views', 'Total Likes', 'VOD Likes', 'Shorts Likes', 'Community Views', 'Community Likes', 'Community Counts'],
                data: [
                    ['4ì›”', '327,139', '903', '133,167', '105,990', '2,378', '287', '2,091', '120,294', '2,596', '13'],
                    ['5ì›”', '327,807', '668', '256,656', '145,872', '4,812', '1,910', '2,902', '330,596', '5,659', '24'],
                    ['6ì›”', '328,528', '721', '363,577', '280,886', '6,087', '740', '5,347', '228,439', '5,456', '15']
                ]
            },
            'youtube-detail': {
                headers: ['Title', 'Date', 'Views', 'Watch Time', 'Subscribers Gained', 'Avg View Duration', 'Impressions', 'CTR', 'Link', 'Thumbnail'],
                data: [
                    ['ì•ˆë¼ì• ì• ì•  [í´ë˜ì‹œ ë¡œì–„]', '6ì›” 15ì¼ (ì¼)', '118,010', '217.3', '62', '0:14', '61,639', '4.3%', 'https://youtube.com/shorts/GVXPALB1_jU', 'https://placehold.co/480x270/cccccc/333333?text=Video1'],
                    ['(ìë§‰) ì‹ ê·œ ê²Œì„ ëª¨ë“œ?! TVë¡œì–„', '6ì›” 29ì¼ (ì¼)', '70,958', '1963.5', '218', '1:39', '247,281', '12.4%', 'https://youtu.be/FL7vvTfWRA0', 'https://placehold.co/480x270/cccccc/333333?text=Video2'],
                    ['(ìë§‰) ê²€ vs ì² í‡´! [í´ë˜ì‹œ ë¡œì–„]', '6ì›” 27ì¼ (ê¸ˆ)', '46,354', '204.9', '81', '0:26', '114,358', '12.5%', 'https://youtube.com/shorts/QKdUFN77j3Q', 'https://placehold.co/480x270/cccccc/333333?text=Video3']
                ]
            },
            'naver-cafe': {
                headers: ['Status', 'Join', 'Posts', 'Total Views', 'Comments', 'Unique Visitors', 'Avg Visits', 'Avg Duration', 'Return Rate'],
                data: [
                    ['4ì›”', '207,716', '1,846', '442,284', '5,213', '27,952', '3.9', '2m 52s', '23%'],
                    ['5ì›”', '208,366', '2,009', '500,689', '5,521', '45,861', '2.9', '1m 57s', '16.2%'],
                    ['6ì›”', '209,411', '2,372', '515,864', '7,052', '39,820', '3.3', '47s', '22.7%']
                ]
            },
            'dau': {
                headers: ['Date', 'DAU', 'Platform', 'Region'],
                data: [
                    ['2025-06-01', '18500', 'Mobile', 'Korea'],
                    ['2025-06-02', '19200', 'Mobile', 'Korea'],
                    ['2025-06-03', '21400', 'Mobile', 'Korea'],
                    ['2025-06-04', '22100', 'Mobile', 'Korea'],
                    ['2025-06-05', '20800', 'Mobile', 'Korea']
                ]
            }
        };

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            excelProcessor = new ExcelDataProcessor(); // Initialize here
            setupNavigation();
            setupFileUpload();
            initializeCharts();
            loadInitialData();
            setupPeriodSelectors();
            updateReportDate();
            setupCustomContentModal();
        });

        function setupNavigation() {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    
                    document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.getElementById(targetId).scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                });
            });
        }

        function setupFileUpload() {
            const uploadZone = document.getElementById('fileUploadZone');
            const fileInput = uploadZone.querySelector('input[type="file"]');
            
            uploadZone.addEventListener('click', () => fileInput.click());
            
            ['dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadZone.addEventListener(eventName, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (eventName === 'dragover') {
                        this.classList.add('dragover');
                    } else if (eventName === 'dragleave') {
                        this.classList.remove('dragover');
                    } else if (eventName === 'drop') {
                        this.classList.remove('dragover');
                        if (e.dataTransfer.files.length > 0) {
                            handleFileUpload(e.dataTransfer.files[0]);
                        }
                    }
                });
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileUpload(e.target.files[0]);
                }
            });
        }

        function updateUploadInfo() {
            const dataType = document.getElementById('dataTypeSelector').value;
            const uploadInfo = document.getElementById('uploadInfo');
            
            if (!dataType) {
                if (uploadInfo) uploadInfo.style.display = 'none';
                return;
            }
            
            if (uploadInfo) {
                uploadInfo.style.display = 'block';
                const infoTexts = {
                    'youtube-total': 'ğŸ“º YouTube ì›”ë³„ ì¢…í•© ë°ì´í„°: êµ¬ë…ì, ì¡°íšŒìˆ˜, ì¢‹ì•„ìš” ë“± ì›”ë³„ ì§‘ê³„ ë°ì´í„°',
                    'youtube-detail': 'ğŸ¬ YouTube ê°œë³„ ì˜ìƒ ë°ì´í„°: ì œëª©, ì¡°íšŒìˆ˜, ì‹œì²­ì‹œê°„, ì¸ë„¤ì¼ ë“± ì˜ìƒë³„ ìƒì„¸ ì •ë³´',
                    'naver-cafe': 'ğŸ’¬ Naver Cafe ë°ì´í„°: ê°€ì…ì, ê²Œì‹œê¸€, ëŒ“ê¸€, ë°©ë¬¸ì ë“± ì»¤ë®¤ë‹ˆí‹° í™œë™ ë°ì´í„°',
                    'dau': 'ğŸ‘¥ DAU ë°ì´í„°: ì¼ë³„ í™œì„± ì‚¬ìš©ì ìˆ˜, í”Œë«í¼ë³„ êµ¬ë¶„ ë°ì´í„°'
                };
                uploadInfo.innerHTML = infoTexts[dataType] || '';
            }
        }

        function downloadSample(type) {
            const template = sampleDataTemplates[type];
            if (!template) return;
            
            const csvContent = [
                template.headers.join(','),
                ...template.data.map(row => row.join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `clash_royale_${type}_sample.csv`;
            link.click();
            URL.revokeObjectURL(url);
            
            showNotification(`ğŸ“¥ ${type} ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤!`, 'success');
        }

        // Excel íŒŒì¼ ì²˜ë¦¬ë¥¼ ìœ„í•œ ê³ ê¸‰ ë°ì´í„° ì²˜ë¦¬ í´ë˜ìŠ¤
        class ExcelDataProcessor {
            constructor() {
                this.requiredSheets = ['Naver Cafe', 'Youtube', 'Youtube(ALL)', 'Youtube community'];
                this.processedData = {};
                this.missingData = [];
                this.calculatedData = {};
            }

            async processExcelFile(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = async (e) => {
                        try {
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { 
                                type: 'array',
                                cellStyles: true,
                                cellFormulas: true,
                                cellDates: true
                            });
                            
                            showNotification('ğŸ“‹ Excel íŒŒì¼ ë¶„ì„ ì¤‘...', 'info');
                            
                            const result = await this.analyzeWorkbook(workbook);
                            resolve(result);
                        } catch (error) {
                            reject(error);
                        }
                    };
                    reader.onerror = () => reject(new Error('íŒŒì¼ ì½ê¸° ì‹¤íŒ¨'));
                    reader.readAsArrayBuffer(file);
                });
            }

            async analyzeWorkbook(workbook) {
                const availableSheets = workbook.SheetNames;
                const analysisResult = {
                    availableSheets,
                    processedSheets: {},
                    missingSheets: [],
                    dataQuality: {},
                    calculatedFields: {}
                };

                // í•„ìš”í•œ ì‹œíŠ¸ í™•ì¸
                this.requiredSheets.forEach(sheetName => {
                    if (!availableSheets.includes(sheetName)) {
                        analysisResult.missingSheets.push(sheetName);
                    }
                });

                // ê° ì‹œíŠ¸ ì²˜ë¦¬
                for (const sheetName of availableSheets) {
                    if (this.requiredSheets.includes(sheetName)) {
                        try {
                            const worksheet = workbook.Sheets[sheetName];
                            const sheetData = await this.processSheet(worksheet, sheetName);
                            analysisResult.processedSheets[sheetName] = sheetData;
                            analysisResult.dataQuality[sheetName] = this.assessDataQuality(sheetData);
                        } catch (error) {
                            console.error(`${sheetName} ì‹œíŠ¸ ì²˜ë¦¬ ì˜¤ë¥˜:`, error);
                            analysisResult.missingSheets.push(`${sheetName} (ì²˜ë¦¬ ì˜¤ë¥˜)`);
                        }
                    }
                }

                // ê³„ì‚° í•„ë“œ ìƒì„±
                analysisResult.calculatedFields = this.generateCalculatedFields(analysisResult.processedSheets);
                this.processedData = analysisResult; // Store the full analysis result

                return analysisResult;
            }

            async processSheet(worksheet, sheetName) {
                const rawData = XLSX.utils.sheet_to_json(worksheet, { 
                    header: 1,
                    defval: null,
                    raw: false
                });

                // ë¹ˆ í–‰ ì œê±°
                const cleanData = rawData.filter(row => 
                    row.some(cell => cell !== null && cell !== undefined && cell.toString().trim() !== '')
                );

                if (cleanData.length === 0) {
                    throw new Error(`${sheetName} ì‹œíŠ¸ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤`);
                }

                // ì‹œíŠ¸ë³„ íŠ¹í™” ì²˜ë¦¬
                switch (sheetName) {
                    case 'Naver Cafe':
                        return this.processNaverCafeSheet(cleanData);
                    case 'Youtube':
                        return this.processYoutubeSheet(cleanData);
                    case 'Youtube(ALL)':
                        return this.processYoutubeAllSheet(cleanData);
                    case 'Youtube community':
                        return this.processYoutubeCommunitySheet(cleanData);
                    default:
                        return this.processGenericSheet(cleanData);
                }
            }

            processNaverCafeSheet(data) {
                // í—¤ë” ì°¾ê¸°
                let headerRow = -1;
                for (let i = 0; i < Math.min(data.length, 10); i++) {
                    const row = data[i];
                    if (row.some(cell => 
                        cell !== null && cell !== undefined && typeof cell === 'string' && (cell.includes('ê¸°ê°„') || cell.includes('ì¡°íšŒìˆ˜') || cell.includes('ê²Œì‹œê¸€'))
                    )) {
                        headerRow = i;
                        break;
                    }
                }

                if (headerRow === -1) {
                    throw new Error('Naver Cafe ë°ì´í„°ì˜ í—¤ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }

                const headers = data[headerRow].map(h => h ? h.toString().trim() : '');
                const processedData = {
                    headers,
                    rows: [],
                    monthlyData: {},
                    ageDistribution: {},
                    calculations: {}
                };

                // ë°ì´í„° í–‰ ì²˜ë¦¬
                for (let i = headerRow + 1; i < data.length; i++) {
                    const row = data[i];
                    if (!row || row.every(cell => !cell || (typeof cell === 'string' && cell.trim() === ''))) continue;

                    const rowData = {};
                    headers.forEach((header, index) => {
                        if (header) { // Ensure header is not null/undefined
                            rowData[header] = row[index] !== undefined && row[index] !== null ? row[index] : '';
                        }
                    });

                    processedData.rows.push(rowData);

                    // ì›”ë³„ ë°ì´í„° ì¶”ì¶œ
                    const period = rowData['ê¸°ê°„'] || rowData['Period'] || rowData['Status'];
                    if (period && (typeof period === 'string' && (period.match(/\d{4}[.\-/]\d{1,2}/) || period.includes('ì›”')))) {
                        processedData.monthlyData[period] = rowData;
                    }
                }

                // ìë™ ê³„ì‚°
                processedData.calculations = this.calculateNaverMetrics(processedData);
                
                return processedData;
            }

            processYoutubeSheet(data) {
                let headerRow = -1;
                for (let i = 0; i < Math.min(data.length, 10); i++) {
                    const row = data[i];
                    if (row.some(cell => 
                        cell !== null && cell !== undefined && typeof cell === 'string' && (cell.includes('Subscriber') || cell.includes('Views') || cell.includes('êµ¬ë…ì'))
                    )) {
                        headerRow = i;
                        break;
                    }
                }

                if (headerRow === -1) {
                    throw new Error('YouTube ë°ì´í„°ì˜ í—¤ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }

                const headers = data[headerRow].map(h => h ? h.toString().trim() : '');
                const processedData = {
                    headers,
                    rows: [],
                    monthlyData: {},
                    calculations: {}
                };

                for (let i = headerRow + 1; i < data.length; i++) {
                    const row = data[i];
                    if (!row || row.every(cell => !cell || (typeof cell === 'string' && cell.trim() === ''))) continue;

                    const rowData = {};
                    headers.forEach((header, index) => {
                        if (header) { // Ensure header is not null/undefined
                            rowData[header] = this.parseNumericValue(row[index]);
                        }
                    });

                    processedData.rows.push(rowData);

                    // ì›”ë³„ ë°ì´í„° ì‹ë³„
                    const status = rowData['Status'] || rowData['ê¸°ê°„'] || rowData['Month'];
                    if (status && (typeof status === 'string' && (status.includes('ì›”') || status.match(/\d{1,2}/)))) {
                        processedData.monthlyData[status] = rowData;
                    }
                }

                processedData.calculations = this.calculateYoutubeMetrics(processedData);
                return processedData;
            }

            processYoutubeAllSheet(data) {
                let headerRow = -1;
                for (let i = 0; i < Math.min(data.length, 10); i++) {
                    const row = data[i];
                    if (row.some(cell => 
                        cell !== null && cell !== undefined && typeof cell === 'string' && (cell.includes('Title') || cell.includes('ì œëª©') || cell.includes('View') || cell.includes('ì¡°íšŒ'))
                    )) {
                        headerRow = i;
                        break;
                    }
                }

                if (headerRow === -1) {
                    throw new Error('YouTube(ALL) ë°ì´í„°ì˜ í—¤ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }

                const headers = data[headerRow].map(h => h ? h.toString().trim() : '');
                const processedData = {
                    headers,
                    rows: [],
                    videoData: [],
                    calculations: {}
                };

                for (let i = headerRow + 1; i < data.length; i++) {
                    const row = data[i];
                    if (!row || row.every(cell => !cell || (typeof cell === 'string' && cell.trim() === ''))) continue;

                    const rowData = {};
                    headers.forEach((header, index) => {
                        if (header) { // Ensure header is not null/undefined
                            const value = row[index];
                            if (header.includes('View') || header.includes('ì¡°íšŒìˆ˜') || 
                                header.includes('Like') || header.includes('ì¢‹ì•„ìš”') ||
                                header.includes('Click') || header.includes('í´ë¦­')) {
                                rowData[header] = this.parseNumericValue(value);
                            } else {
                                rowData[header] = value !== undefined && value !== null ? value : '';
                            }
                        }
                    });

                    processedData.rows.push(rowData);
                    processedData.videoData.push(rowData);
                }

                processedData.calculations = this.calculateVideoMetrics(processedData);
                return processedData;
            }

            processYoutubeCommunitySheet(data) {
                let headerRow = -1;
                for (let i = 0; i < Math.min(data.length, 10); i++) {
                    const row = data[i];
                    if (row.some(cell => 
                        cell !== null && cell !== undefined && typeof cell === 'string' && (cell.includes('Community') || cell.includes('ì»¤ë®¤ë‹ˆí‹°') || cell.includes('Likes'))
                    )) {
                        headerRow = i;
                        break;
                    }
                }

                if (headerRow === -1) {
                    throw new Error('YouTube Community ë°ì´í„°ì˜ í—¤ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }

                const headers = data[headerRow].map(h => h ? h.toString().trim() : '');
                const processedData = {
                    headers,
                    rows: [],
                    communityData: {},
                    calculations: {}
                };

                for (let i = headerRow + 1; i < data.length; i++) {
                    const row = data[i];
                    if (!row || row.every(cell => !cell || (typeof cell === 'string' && cell.trim() === ''))) continue;

                    const rowData = {};
                    headers.forEach((header, index) => {
                        if (header) { // Ensure header is not null/undefined
                            rowData[header] = this.parseNumericValue(row[index]);
                        }
                    });

                    processedData.rows.push(rowData);
                }

                processedData.calculations = this.calculateCommunityMetrics(processedData);
                return processedData;
            }

            processGenericSheet(data) {
                if (data.length === 0) return { headers: [], rows: [] };
                
                return {
                    headers: data[0] || [],
                    rows: data.slice(1).map(row => {
                        const rowObj = {};
                        data[0].forEach((header, index) => {
                            if (header) { // Ensure header is not null/undefined
                                rowObj[header] = row[index] !== undefined && row[index] !== null ? row[index] : '';
                            }
                        });
                        return rowObj;
                    })
                };
            }

            parseNumericValue(value) {
                if (value === null || value === undefined || value === '') return 0;
                if (typeof value === 'number') return value;
                
                const strValue = value.toString();
                
                // í¼ì„¼íŠ¸ ì²˜ë¦¬
                if (strValue.includes('%')) {
                    return parseFloat(strValue.replace(/[%,\s]/g, ''));
                }
                
                // ìˆ«ì ì¶”ì¶œ (ì‰¼í‘œ, ê³µë°± ì œê±°)
                const numericMatch = strValue.replace(/[,\s]/g, '').match(/[\d.]+/);
                return numericMatch ? parseFloat(numericMatch[0]) : 0;
            }

            calculateNaverMetrics(data) {
                const calculations = {
                    totalViews: 0,
                    totalPosts: 0,
                    totalComments: 0,
                    totalMembers: 0,
                    averageEngagement: 0,
                    monthlyGrowth: {},
                    missingFields: []
                };

                if (!data.rows || data.rows.length === 0) {
                    calculations.missingFields.push('ê¸°ë³¸ ë°ì´í„° ì—†ìŒ');
                    return calculations;
                }

                // í•„ë“œ ë§¤í•‘ (í•œê¸€/ì˜ì–´ ëŒ€ì‘)
                const fieldMap = {
                    views: ['ì¡°íšŒìˆ˜', 'Views', 'Total Views'],
                    posts: ['ê²Œì‹œê¸€ìˆ˜', 'Posts', 'Post Count'],
                    comments: ['ëŒ“ê¸€ìˆ˜', 'Comments', 'Comment Count'],
                    members: ['ì‹ ê·œ ê°€ì…ììˆ˜', 'Join', 'New Members']
                };

                data.rows.forEach(row => {
                    // ì¡°íšŒìˆ˜ í•©ê³„
                    const views = this.findFieldValue(row, fieldMap.views);
                    if (views > 0) calculations.totalViews += views;

                    // ê²Œì‹œê¸€ í•©ê³„
                    const posts = this.findFieldValue(row, fieldMap.posts);
                    if (posts > 0) calculations.totalPosts += posts;

                    // ëŒ“ê¸€ í•©ê³„
                    const comments = this.findFieldValue(row, fieldMap.comments);
                    if (comments > 0) calculations.totalComments += comments;

                    // ì‹ ê·œ ê°€ì…ì í•©ê³„
                    const members = this.findFieldValue(row, fieldMap.members);
                    if (members > 0) calculations.totalMembers += members;
                });

                // í‰ê·  ì°¸ì—¬ë„ ê³„ì‚° (ëŒ“ê¸€/ê²Œì‹œê¸€ ë¹„ìœ¨)
                if (calculations.totalPosts > 0) {
                    calculations.averageEngagement = calculations.totalComments / calculations.totalPosts;
                }

                // ëˆ„ë½ëœ í•„ë“œ í™•ì¸
                Object.keys(fieldMap).forEach(key => {
                    const found = data.rows.some(row => 
                        fieldMap[key].some(field => row[field] !== undefined && row[field] !== 0)
                    );
                    if (!found) {
                        calculations.missingFields.push(`${key} ë°ì´í„° ëˆ„ë½`);
                    }
                });

                return calculations;
            }

            calculateYoutubeMetrics(data) {
                const calculations = {
                    totalSubscribers: 0,
                    totalViews: 0,
                    totalLikes: 0,
                    averageViewsPerVideo: 0,
                    engagementRate: 0,
                    monthlyGrowth: {},
                    missingFields: []
                };

                if (!data.rows || data.rows.length === 0) {
                    calculations.missingFields.push('ê¸°ë³¸ ë°ì´í„° ì—†ìŒ');
                    return calculations;
                }

                const fieldMap = {
                    subscribers: ['Subscriber', 'êµ¬ë…ì', 'Subscribers'],
                    vodViews: ['VOD Views', 'VOD ì¡°íšŒìˆ˜', 'Video Views'],
                    shortsViews: ['Shorts Views', 'Shorts ì¡°íšŒìˆ˜', 'Short Views'],
                    totalLikes: ['Total Likes', 'ì´ ì¢‹ì•„ìš”', 'Likes'],
                    communityViews: ['Community Views', 'ì»¤ë®¤ë‹ˆí‹° ì¡°íšŒìˆ˜'],
                };

                // ìµœì‹  ì›” ë°ì´í„° ìš°ì„  ì‚¬ìš©
                const latestData = data.rows[data.rows.length - 1] || {};

                calculations.totalSubscribers = this.findFieldValue(latestData, fieldMap.subscribers);

                data.rows.forEach(row => {
                    const vodViews = this.findFieldValue(row, fieldMap.vodViews);
                    const shortsViews = this.findFieldValue(row, fieldMap.shortsViews);
                    const likes = this.findFieldValue(row, fieldMap.totalLikes);

                    calculations.totalViews += vodViews + shortsViews;
                    calculations.totalLikes += likes;
                });

                // ì°¸ì—¬ìœ¨ ê³„ì‚° (ì¢‹ì•„ìš”/ì¡°íšŒìˆ˜)
                if (calculations.totalViews > 0) {
                    calculations.engagementRate = (calculations.totalLikes / calculations.totalViews) * 100;
                }

                // ì›”ë³„ ì„±ì¥ë¥  ê³„ì‚°
                if (data.rows.length >= 2) {
                    const firstMonth = data.rows[0];
                    const lastMonth = data.rows[data.rows.length - 1];
                    
                    const firstSubs = this.findFieldValue(firstMonth, fieldMap.subscribers);
                    const lastSubs = this.findFieldValue(lastMonth, fieldMap.subscribers);
                    
                    if (firstSubs > 0) {
                        calculations.monthlyGrowth.subscribers = ((lastSubs - firstSubs) / firstSubs * 100).toFixed(1);
                    }
                }

                // ëˆ„ë½ í•„ë“œ í™•ì¸
                Object.keys(fieldMap).forEach(key => {
                    const found = data.rows.some(row => 
                        fieldMap[key].some(field => row[field] !== undefined && row[field] !== 0)
                    );
                    if (!found) {
                        calculations.missingFields.push(`${key} ë°ì´í„° ëˆ„ë½`);
                    }
                });

                return calculations;
            }

            calculateVideoMetrics(data) {
                const calculations = {
                    totalVideos: 0,
                    averageViews: 0,
                    topVideos: [],
                    totalEngagement: 0,
                    missingFields: []
                };

                if (!data.videoData || data.videoData.length === 0) {
                    calculations.missingFields.push('ë¹„ë””ì˜¤ ë°ì´í„° ì—†ìŒ');
                    return calculations;
                }

                calculations.totalVideos = data.videoData.length;

                const fieldMap = {
                    views: ['Views', 'ì¡°íšŒìˆ˜'],
                    likes: ['Likes', 'ì¢‹ì•„ìš”'],
                    title: ['Title', 'ì œëª©', 'Video Title'],
                    link: ['Link', 'ë§í¬', 'URL', 'Video Link'],
                    thumbnail: ['Thumbnail', 'ì¸ë„¤ì¼', 'Image']
                };

                let totalViews = 0;
                let totalLikes = 0;

                data.videoData.forEach(video => {
                    const views = this.findFieldValue(video, fieldMap.views);
                    const likes = this.findFieldValue(video, fieldMap.likes);
                    const title = this.findFieldValue(video, fieldMap.title);

                    totalViews += views;
                    totalLikes += likes;

                    // ìƒìœ„ ë¹„ë””ì˜¤ ìˆ˜ì§‘ (ì¡°íšŒìˆ˜ ê¸°ì¤€)
                    if (views > 0 && title) {
                        calculations.topVideos.push({
                            title: title,
                            views: views,
                            likes: likes,
                            link: this.findFieldValue(video, fieldMap.link) || '#',
                            thumbnail: this.findFieldValue(video, fieldMap.thumbnail) || `https://placehold.co/480x270/cccccc/333333?text=${encodeURIComponent(title.substring(0, 10))}`
                        });
                    }
                });

                calculations.averageViews = calculations.totalVideos > 0 ? totalViews / calculations.totalVideos : 0;
                calculations.totalEngagement = totalLikes;

                // ìƒìœ„ ë¹„ë””ì˜¤ ì •ë ¬ (ì¡°íšŒìˆ˜ ê¸°ì¤€)
                calculations.topVideos.sort((a, b) => b.views - a.views);
                calculations.topVideos = calculations.topVideos.slice(0, 10); // ìƒìœ„ 10ê°œë§Œ

                return calculations;
            }

            calculateCommunityMetrics(data) {
                const calculations = {
                    totalCommunityViews: 0,
                    totalCommunityLikes: 0,
                    totalCommunityPosts: 0,
                    averageEngagement: 0,
                    missingFields: []
                };

                if (!data.rows || data.rows.length === 0) {
                    calculations.missingFields.push('ì»¤ë®¤ë‹ˆí‹° ë°ì´í„° ì—†ìŒ');
                    return calculations;
                }

                const fieldMap = {
                    views: ['Community Views', 'ì»¤ë®¤ë‹ˆí‹° ì¡°íšŒìˆ˜', 'Views'],
                    likes: ['Community Likes', 'ì»¤ë®¤ë‹ˆí‹° ì¢‹ì•„ìš”', 'Likes'],
                    counts: ['Community Counts', 'ì»¤ë®¤ë‹ˆí‹° ê°œìˆ˜', 'Posts', 'Count']
                };

                data.rows.forEach(row => {
                    calculations.totalCommunityViews += this.findFieldValue(row, fieldMap.views);
                    calculations.totalCommunityLikes += this.findFieldValue(row, fieldMap.likes);
                    calculations.totalCommunityPosts += this.findFieldValue(row, fieldMap.counts);
                });

                if (calculations.totalCommunityViews > 0) {
                    calculations.averageEngagement = (calculations.totalCommunityLikes / calculations.totalCommunityViews) * 100;
                }

                return calculations;
            }

            findFieldValue(row, possibleFields) {
                for (const field of possibleFields) {
                    if (row[field] !== undefined && row[field] !== null) {
                        return this.parseNumericValue(row[field]);
                    }
                }
                return 0;
            }

            assessDataQuality(sheetData) {
                let quality = 100;
                const issues = [];

                if (!sheetData.rows || sheetData.rows.length === 0) {
                    quality = 0;
                    issues.push('ë°ì´í„° ì—†ìŒ');
                    return { score: quality, issues };
                }

                // ë¹ˆ ê°’ ë¹„ìœ¨ ê²€ì‚¬
                const totalCells = sheetData.rows.length * (sheetData.headers?.length || 0);
                let emptyCells = 0;

                sheetData.rows.forEach(row => {
                    Object.values(row).forEach(value => {
                        if (value === null || value === undefined || value === '') {
                            emptyCells++;
                        }
                    });
                });

                const emptyRatio = emptyCells / totalCells;
                if (emptyRatio > 0.3) {
                    quality -= 30;
                    issues.push('ë¹ˆ ê°’ ê³¼ë‹¤ (30% ì´ìƒ)');
                } else if (emptyRatio > 0.1) {
                    quality -= 15;
                    issues.push('ë¹ˆ ê°’ ë‹¤ìˆ˜ (10% ì´ìƒ)');
                }

                // ê³„ì‚°ëœ ë©”íŠ¸ë¦­ì˜ ëˆ„ë½ í™•ì¸
                if (sheetData.calculations?.missingFields?.length > 0) {
                    quality -= sheetData.calculations.missingFields.length * 10;
                    issues.push(...sheetData.calculations.missingFields);
                }

                return { 
                    score: Math.max(0, quality), 
                    issues: issues.length > 0 ? issues : ['ì–‘í˜¸'] 
                };
            }

            generateCalculatedFields(processedSheets) {
                const calculated = {};

                if (processedSheets['Youtube']) {
                    calculated.youtubeGrowth = this.calculateGrowthRates(processedSheets['Youtube']);
                }

                if (processedSheets['Naver Cafe']) {
                    calculated.naverEngagement = this.calculateEngagementMetrics(processedSheets['Naver Cafe']);
                }

                if (processedSheets['Youtube(ALL)']) {
                    calculated.topPerformers = this.identifyTopPerformers(processedSheets['Youtube(ALL)']);
                }

                return calculated;
            }

            calculateGrowthRates(youtubeData) {
                if (!youtubeData.rows || youtubeData.rows.length < 2) return null;

                const growth = {};
                const firstMonth = youtubeData.rows[0];
                const lastMonth = youtubeData.rows[youtubeData.rows.length - 1];

                const fields = ['Subscriber', 'VOD Views', 'Shorts Views', 'Total Likes'];
                fields.forEach(field => {
                    const firstValue = this.parseNumericValue(firstMonth[field]);
                    const lastValue = this.parseNumericValue(lastMonth[field]);
                    
                    if (firstValue > 0) {
                        growth[field] = ((lastValue - firstValue) / firstValue * 100).toFixed(1);
                    }
                });

                return growth;
            }

            calculateEngagementMetrics(naverData) {
                if (!naverData.calculations) return null;
                
                return {
                    postsPerDay: naverData.calculations.totalPosts / 30, // ì›” í‰ê· 
                    commentsPerPost: naverData.calculations.averageEngagement,
                    totalActivity: naverData.calculations.totalPosts + naverData.calculations.totalComments
                };
            }

            identifyTopPerformers(youtubeAllData) {
                if (!youtubeAllData.calculations?.topVideos) return null;

                return {
                    mostViewed: youtubeAllData.calculations.topVideos[0] || null,
                    topThree: youtubeAllData.calculations.topVideos.slice(0, 3)
                };
            }
        }

        // Excel/CSV íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ (ê°œì„ ëœ ë²„ì „)
        async function handleFileUpload(file) {
            const fileName = file.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls');
            const isCSV = fileName.endsWith('.csv');
            
            if (!isExcel && !isCSV) {
                showNotification('âŒ Excel (.xlsx) ë˜ëŠ” CSV íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤', 'error');
                return;
            }

            showNotification(`ğŸ“Š ${isExcel ? 'Excel' : 'CSV'} íŒŒì¼ ë¶„ì„ ì¤‘...`, 'info');
            
            try {
                let analysisResult;
                
                if (isExcel) {
                    // Excel íŒŒì¼ ì²˜ë¦¬
                    analysisResult = await excelProcessor.processExcelFile(file);
                    uploadedData = analysisResult.processedSheets; // Store processed sheets
                    await handleExcelAnalysis(analysisResult);
                } else {
                    // ê¸°ì¡´ CSV ì²˜ë¦¬
                    const dataType = document.getElementById('dataTypeSelector').value;
                    if (!dataType) {
                        showNotification('âŒ CSV íŒŒì¼ì˜ ê²½ìš° ë°ì´í„° ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                        return;
                    }
                    const csvData = await handleCSVFile(file, dataType);
                    uploadedData[dataType] = csvData; // Store CSV data
                    analyzeDataQuality(csvData); // Analyze quality for CSV
                    showNotification(`âœ… ${csvData.length}ê°œ CSV ë ˆì½”ë“œê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
                }
                
            } catch (error) {
                console.error('íŒŒì¼ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                showNotification(`âŒ íŒŒì¼ ì²˜ë¦¬ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }

        async function handleExcelAnalysis(analysisResult) {
            displayExcelAnalysisResults(analysisResult);
            
            // ìë™ìœ¼ë¡œ ë°ì´í„° ì ìš©
            if (Object.keys(analysisResult.processedSheets).length > 0) {
                await applyExcelDataToReport(analysisResult);
                showNotification('âœ… Excel ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            } else {
                showNotification('âš ï¸ ì²˜ë¦¬ ê°€ëŠ¥í•œ ì‹œíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤', 'warning');
            }
        }

        function displayExcelAnalysisResults(result) {
            let resultDiv = document.getElementById('excelAnalysisResult');
            let contentDiv;

            if (!resultDiv) {
                const container = document.querySelector('.admin-content');
                resultDiv = document.createElement('div');
                resultDiv.id = 'excelAnalysisResult';
                resultDiv.style.cssText = `margin: 20px 0; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--info);`;
                
                const header = document.createElement('h4');
                header.style.marginBottom = '12px';
                header.textContent = 'ğŸ“Š Excel íŒŒì¼ ë¶„ì„ ê²°ê³¼';
                resultDiv.appendChild(header);

                contentDiv = document.createElement('div');
                contentDiv.id = 'analysisContent';
                resultDiv.appendChild(contentDiv);

                container.appendChild(resultDiv);
            } else {
                contentDiv = document.getElementById('analysisContent');
            }
            
            let html = '';
            
            // ì‚¬ìš© ê°€ëŠ¥í•œ ì‹œíŠ¸
            if (result.availableSheets.length > 0) {
                html += `<div style="margin-bottom: 12px;">
                    <strong>âœ… ë°œê²¬ëœ ì‹œíŠ¸:</strong> ${result.availableSheets.join(', ')}
                </div>`;
            }

            // ì²˜ë¦¬ëœ ì‹œíŠ¸
            const processedSheetNames = Object.keys(result.processedSheets);
            if (processedSheetNames.length > 0) {
                html += `<div style="margin-bottom: 12px;">
                    <strong>ğŸ”„ ì²˜ë¦¬ëœ ì‹œíŠ¸:</strong> ${processedSheetNames.join(', ')}
                </div>`;

                // ê° ì‹œíŠ¸ë³„ ë°ì´í„° í’ˆì§ˆ
                processedSheetNames.forEach(sheetName => {
                    const quality = result.dataQuality[sheetName];
                    const qualityColor = quality.score >= 80 ? 'var(--success)' : 
                                         quality.score >= 60 ? 'var(--warning)' : 'var(--error)';
                    html += `<div style="margin: 8px 0; font-size: 13px;">
                        ğŸ“‹ <strong>${sheetName}</strong>: 
                        <span style="color: ${qualityColor}; font-weight: 600;">${quality.score}ì </span>
                        ${quality.issues.length > 0 ? `(${quality.issues.join(', ')})` : ''}
                    </div>`;
                });
            }

            // ëˆ„ë½ëœ ì‹œíŠ¸
            if (result.missingSheets.length > 0) {
                html += `<div style="margin-bottom: 12px; color: var(--warning);">
                    <strong>âš ï¸ ëˆ„ë½ëœ ì‹œíŠ¸:</strong> ${result.missingSheets.join(', ')}
                </div>`;
            }

            // ê³„ì‚°ëœ í•„ë“œ
            if (result.calculatedFields && Object.keys(result.calculatedFields).length > 0) {
                html += `<div style="margin-bottom: 12px;">
                    <strong>ğŸ§® ìë™ ê³„ì‚° ì™„ë£Œ:</strong> 
                    ${Object.keys(result.calculatedFields).join(', ')}
                </div>`;
            }

            contentDiv.innerHTML = html;
        }

        async function applyExcelDataToReport(analysisResult) {
            const { processedSheets } = analysisResult;

            // Naver Cafe ë°ì´í„° ì ìš©
            if (processedSheets['Naver Cafe']) {
                await applyNaverCafeData(processedSheets['Naver Cafe']);
            } else {
                showDataMissingNotice('naver-total', 'Naver Cafe ê¸°ë³¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
            }

            // YouTube ë°ì´í„° ì ìš©
            if (processedSheets['Youtube']) {
                await applyYoutubeData(processedSheets['Youtube']);
            } else {
                showDataMissingNotice('youtube-total', 'YouTube ê¸°ë³¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
            }

            // YouTube ìƒì„¸ ë°ì´í„° ì ìš©
            if (processedSheets['Youtube(ALL)']) {
                await applyYoutubeDetailData(processedSheets['Youtube(ALL)']);
            } else {
                showDataMissingNotice('youtube-detail', 'YouTube ìƒì„¸ ì˜ìƒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
            }

            // YouTube ì»¤ë®¤ë‹ˆí‹° ë°ì´í„° ì ìš©
            if (processedSheets['Youtube community']) {
                await applyYoutubeCommunityData(processedSheets['Youtube community']);
            } else {
                showDataMissingNotice('youtube-community', 'YouTube ì»¤ë®¤ë‹ˆí‹° ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
            }

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateAllCharts();
        }

        async function applyNaverCafeData(naverData) {
            const tbody = document.getElementById('naverMainTableBody');
            tbody.innerHTML = '';

            const monthlyEntries = Object.entries(naverData.monthlyData).sort();
            
            monthlyEntries.forEach(([period, data]) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${period}</strong></td>
                    <td>${formatNumber(excelProcessor.findFieldValue(data, ['Join', 'íšŒì›ê°€ì…']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(data, ['Posts', 'ê²Œì‹œê¸€ìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(data, ['Total Views', 'ì´ ì¡°íšŒìˆ˜', 'ì¡°íšŒìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(data, ['Comments', 'ëŒ“ê¸€ìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(data, ['Unique Visitors', 'ìˆœë°©ë¬¸ììˆ˜']) || 0)}</td>
                    <td>${excelProcessor.findFieldValue(data, ['Avg Visits', 'í‰ê· ë°©ë¬¸íšŸìˆ˜']) || '0'}</td>
                    <td>${excelProcessor.findFieldValue(data, ['Avg Duration', 'í‰ê· ì‚¬ìš©ì‹œê°„']) || '0s'}</td>
                    <td>${excelProcessor.findFieldValue(data, ['Return Rate', 'ì¬ë°©ë¬¸ìœ¨']) || '0%'}</td>
                `;
                tbody.appendChild(tr);
            });

            updateCalculatedMetrics('naver', naverData.calculations);
        }

        async function applyYoutubeData(youtubeData) {
            const tbody = document.getElementById('youtubeMainTableBody');
            tbody.innerHTML = '';

            youtubeData.rows.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${row.Status || row['ê¸°ê°„'] || 'ë°ì´í„° ì—†ìŒ'}</strong></td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Subscriber', 'êµ¬ë…ì']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Videos', 'ì˜ìƒìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['VOD Views', 'VOD ì¡°íšŒìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Shorts Views', 'Shorts ì¡°íšŒìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Total Likes', 'ì´ ì¢‹ì•„ìš”']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['VOD Likes', 'VOD ì¢‹ì•„ìš”']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Shorts Likes', 'Shorts ì¢‹ì•„ìš”']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Community Views', 'ì»¤ë®¤ë‹ˆí‹° ì¡°íšŒìˆ˜']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Community Likes', 'ì»¤ë®¤ë‹ˆí‹° ì¢‹ì•„ìš”']) || 0)}</td>
                    <td>${formatNumber(excelProcessor.findFieldValue(row, ['Community Counts', 'ì»¤ë®¤ë‹ˆí‹° ê°œìˆ˜']) || 0)}</td>
                `;
                tbody.appendChild(tr);
            });

            updateCalculatedMetrics('youtube', youtubeData.calculations);
        }

        async function applyYoutubeDetailData(youtubeAllData) {
            const grid = document.getElementById('topVideosGrid');
            grid.innerHTML = '';
            
            const topVideos = youtubeAllData.calculations.topPerformers?.topThree || [];
            
            if (topVideos.length === 0) {
                showDataMissingNotice('youtube-detail', 'YouTube ìƒì„¸ ì˜ìƒ ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
                return;
            }

            topVideos.forEach((video, index) => {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.innerHTML = `
                    <img src="${video.thumbnail}" 
                         alt="${video.title}" 
                         class="video-thumbnail"
                         onerror="this.src='https://placehold.co/480x270/cccccc/333333?text=Video${index + 1}'">
                    <div class="video-info">
                        <div class="video-title">${video.title}</div>
                        <div class="video-stats">
                            ì¡°íšŒìˆ˜: ${formatNumber(video.views)} | 
                            ì¢‹ì•„ìš”: ${formatNumber(video.likes)}
                        </div>
                        <a href="${video.link}" target="_blank" class="video-link">ì˜ìƒ ë³´ê¸°</a>
                    </div>
                `;
                grid.appendChild(card);
            });

            updateCalculatedMetrics('youtube-detail', youtubeAllData.calculations);
        }

        async function applyYoutubeCommunityData(communityData) {
            const tbody = document.getElementById('youtubeCommunityTable').querySelector('tbody');
            tbody.innerHTML = '';

            const items = ['ê²Œì‹œë¬¼ ìˆ˜', 'ì¢‹ì•„ìš” ìˆ˜', 'ëŒ“ê¸€ ìˆ˜']; // Example items, adjust based on actual data
            const months = ['4ì›”', '5ì›”', '6ì›”']; // Example months, adjust dynamically if needed

            // Assuming communityData.rows contains data for each month
            // Example:
            // { 'Community Counts': 13, 'Community Likes': 2596, 'Community Views': 120294 } for '4ì›”'
            // Need to map these to the table structure
            
            const communityRows = {
                'ê²Œì‹œë¬¼ ìˆ˜': {},
                'ì¢‹ì•„ìš” ìˆ˜': {},
                'ëŒ“ê¸€ ìˆ˜': {}
            };

            communityData.rows.forEach(row => {
                const status = row.Status || row['ê¸°ê°„'] || 'ì›”';
                communityRows['ê²Œì‹œë¬¼ ìˆ˜'][status] = excelProcessor.findFieldValue(row, ['Community Counts', 'ì»¤ë®¤ë‹ˆí‹° ê°œìˆ˜']);
                communityRows['ì¢‹ì•„ìš” ìˆ˜'][status] = excelProcessor.findFieldValue(row, ['Community Likes', 'ì»¤ë®¤ë‹ˆí‹° ì¢‹ì•„ìš”']);
                communityRows['ëŒ“ê¸€ ìˆ˜'][status] = excelProcessor.findFieldValue(row, ['Community Comments', 'ì»¤ë®¤ë‹ˆí‹° ëŒ“ê¸€']); // Assuming there's a comments field
            });

            items.forEach(item => {
                const tr = document.createElement('tr');
                let rowHtml = `<td><strong>${item}</strong></td>`;
                let total = 0;
                months.forEach(month => {
                    const value = communityRows[item][month] || 0;
                    rowHtml += `<td>${formatNumber(value)}</td>`;
                    total += value;
                });
                rowHtml += `<td><strong>${formatNumber(total)}</strong></td>`;
                tr.innerHTML = rowHtml;
                tbody.appendChild(tr);
            });

            updateCalculatedMetrics('youtube-community', communityData.calculations);
        }


        function showDataMissingNotice(sectionId, message) {
            const section = document.getElementById(sectionId);
            if (section) {
                const notice = document.createElement('div');
                notice.className = 'data-missing-notice';
                notice.style.cssText = `
                    background: #fef3cd; 
                    border: 1px solid #ffeaa7; 
                    border-radius: 8px; 
                    padding: 16px; 
                    margin: 16px 0; 
                    color: #856404;
                    text-align: center;
                `;
                notice.innerHTML = `
                    <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">âš ï¸ ë°ì´í„° ëˆ„ë½</div>
                    <div style="font-size: 13px;">${message}</div>
                    <div style="font-size: 12px; margin-top: 8px; opacity: 0.8;">
                        Excel íŒŒì¼ì— í•´ë‹¹ ì‹œíŠ¸ì˜ ë°ì´í„°ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”
                    </div>
                `;
                
                // ê¸°ì¡´ ëˆ„ë½ ì•Œë¦¼ ì œê±° í›„ ìƒˆë¡œ ì¶”ê°€
                const existingNotice = section.querySelector('.data-missing-notice');
                if (existingNotice) existingNotice.remove();
                
                section.appendChild(notice);
            }
        }

        function updateCalculatedMetrics(type, calculations) {
            if (!calculations) return;

            // ê³„ì‚°ëœ ì§€í‘œë¥¼ UIì— í‘œì‹œ
            const metricsDisplay = document.getElementById(`${type}-calculated-metrics`);
            if (metricsDisplay) {
                let html = '<div style="margin: 16px 0; padding: 12px; background: #e8f5e8; border-radius: 8px;">';
                html += '<h5 style="margin-bottom: 8px;">ğŸ§® ìë™ ê³„ì‚°ëœ ì§€í‘œ</h5>';
                
                Object.entries(calculations).forEach(([key, value]) => {
                    if (key !== 'missingFields' && value !== null && value !== undefined) {
                        html += `<div style="font-size: 13px; margin: 4px 0;">
                            <strong>${key}:</strong> ${typeof value === 'number' ? formatNumber(value) : value}
                        </div>`;
                    }
                });
                
                if (calculations.missingFields && calculations.missingFields.length > 0) {
                    html += `<div style="margin-top: 8px; font-size: 12px; color: var(--warning);">
                        <strong>ëˆ„ë½ í•„ë“œ:</strong> ${calculations.missingFields.join(', ')}
                    </div>`;
                }
                
                html += '</div>';
                metricsDisplay.innerHTML = html;
            }
        }

        async function handleCSVFile(file, dataType) {
            const reader = new FileReader();
            
            return new Promise((resolve, reject) => {
                reader.onload = function(e) {
                    Papa.parse(e.target.result, {
                        header: true,
                        dynamicTyping: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            if (results.errors.length > 0) {
                                reject(new Error('CSV íŒŒì‹± ì˜¤ë¥˜: ' + results.errors[0].message));
                                return;
                            }
                            
                            uploadedData[dataType] = results.data;
                            analyzeDataQuality(results.data);
                            showNotification(`âœ… ${results.data.length}ê°œ CSV ë ˆì½”ë“œê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
                            resolve(results.data);
                        },
                        error: function(error) {
                            reject(new Error('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: ' + error.message));
                        }
                    });
                };
                reader.onerror = () => reject(new Error('íŒŒì¼ ì½ê¸° ì‹¤íŒ¨'));
                reader.readAsText(file, 'utf-8');
            });
        }

        function analyzeDataQuality(data) {
            if (!data || data.length === 0) {
                updateQualityDisplay(0, 'ë°ì´í„° ì—†ìŒ');
                return;
            }
            
            let quality = 100;
            const issues = [];
            
            // ê²°ì¸¡ì¹˜ ê²€ì‚¬
            let missingCount = 0;
            const totalCells = data.length * Object.keys(data[0]).length;
            
            data.forEach(row => {
                Object.values(row).forEach(value => {
                    if (value === null || value === undefined || value === '') {
                        missingCount++;
                    }
                });
            });
            
            const missingRate = missingCount / totalCells;
            if (missingRate > 0.1) {
                quality -= 20;
                issues.push('ê²°ì¸¡ì¹˜ ë‹¤ìˆ˜');
            }
            
            // ë°ì´í„° ì¼ê´€ì„± ê²€ì‚¬
            const headers = Object.keys(data[0]);
            let inconsistentCols = 0;
            
            headers.forEach(header => {
                const types = new Set();
                data.slice(0, 10).forEach(row => {
                    if (row[header] !== null && row[header] !== undefined) {
                        types.add(typeof row[header]);
                    }
                });
                if (types.size > 1) inconsistentCols++;
            });
            
            if (inconsistentCols > headers.length * 0.2) {
                quality -= 15;
                issues.push('íƒ€ì… ë¶ˆì¼ì¹˜');
            }
            
            quality = Math.max(0, quality);
            const status = quality >= 90 ? 'ìµœìš°ìˆ˜' : 
                           quality >= 80 ? 'ìš°ìˆ˜' : 
                           quality >= 70 ? 'ì–‘í˜¸' : 
                           quality >= 60 ? 'ë³´í†µ' : 'ê°œì„ í•„ìš”';
            
            updateQualityDisplay(quality, status, issues);
        }

        function updateQualityDisplay(score, status, issues = []) {
            const infoDiv = document.getElementById('dataQualityInfo');
            const bar = document.getElementById('qualityBar');
            const text = document.getElementById('qualityText');
            
            infoDiv.style.display = 'block';
            bar.style.width = score + '%';
            
            if (score >= 80) bar.style.background = 'var(--success)';
            else if (score >= 60) bar.style.background = 'var(--warning)';
            else bar.style.background = 'var(--error)';
            
            text.textContent = `í’ˆì§ˆ ì ìˆ˜: ${score.toFixed(0)}% (${status})`;
            if (issues.length > 0) {
                text.textContent += ` - ì´ìŠˆ: ${issues.join(', ')}`;
            }
        }

        function processUploadedData() {
            if (Object.keys(uploadedData).length === 0) {
                showNotification('âŒ ì—…ë¡œë“œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            showNotification('ğŸ”„ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
            
            setTimeout(() => {
                // Assuming excelProcessor.processedData holds the full analysis result
                if (excelProcessor.processedData && Object.keys(excelProcessor.processedData.processedSheets).length > 0) {
                    applyExcelDataToReport(excelProcessor.processedData);
                } else {
                    // Fallback for CSV or if Excel processing failed to populate processedSheets
                    if (uploadedData['youtube-total']) {
                        updateYouTubeMainTable(uploadedData['youtube-total']);
                    }
                    if (uploadedData['youtube-detail']) {
                        updateYouTubeDetailSection(uploadedData['youtube-detail']);
                    }
                    if (uploadedData['naver-cafe']) {
                        updateNaverMainTable(uploadedData['naver-cafe']);
                    }
                    if (uploadedData['youtube-community']) {
                        applyYoutubeCommunityData(uploadedData['youtube-community']);
                    }
                }
                
                updateAllCharts();
                
                showNotification('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                closeAdminPanel();
            }, 1500);
        }

        function updateYouTubeMainTable(data) {
            const tbody = document.getElementById('youtubeMainTableBody');
            tbody.innerHTML = '';
            
            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${row.Status || row['Status'] || ''}</strong></td>
                    <td>${formatNumber(row.Subscriber || row['êµ¬ë…ì'] || 0)}</td>
                    <td>${formatNumber(row.Videos || row['ì˜ìƒìˆ˜'] || 0)}</td>
                    <td>${formatNumber(row['VOD Views'] || row['VOD ì¡°íšŒìˆ˜'] || 0)}</td>
                    <td>${formatNumber(row['Shorts Views'] || row['Shorts ì¡°íšŒìˆ˜'] || 0)}</td>
                    <td>${formatNumber(row['Total Likes'] || row['ì´ ì¢‹ì•„ìš”'] || 0)}</td>
                    <td>${formatNumber(row['VOD Likes'] || row['VOD ì¢‹ì•„ìš”'] || 0)}</td>
                    <td>${formatNumber(row['Shorts Likes'] || row['Shorts ì¢‹ì•„ìš”'] || 0)}</td>
                    <td>${formatNumber(row['Community Views'] || row['ì»¤ë®¤ë‹ˆí‹° ì¡°íšŒìˆ˜'] || 0)}</td>
                    <td>${formatNumber(row['Community Likes'] || row['ì»¤ë®¤ë‹ˆí‹° ì¢‹ì•„ìš”'] || 0)}</td>
                    <td>${formatNumber(row['Community Counts'] || row['ì»¤ë®¤ë‹ˆí‹° ê°œìˆ˜'] || 0)}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function updateYouTubeDetailSection(data) {
            const grid = document.getElementById('topVideosGrid');
            grid.innerHTML = '';
            
            // ì¡°íšŒìˆ˜ ê¸°ì¤€ ìƒìœ„ 3ê°œ ì„ íƒ
            const sortedTopVideos = data
                .sort((a, b) => (parseFloat(b.Views || b['ì¡°íšŒìˆ˜'] || 0)) - (parseFloat(a.Views || a['ì¡°íšŒìˆ˜'] || 0)))
                .slice(0, 3);

            if (sortedTopVideos.length === 0) {
                showDataMissingNotice('youtube-detail', 'YouTube ìƒì„¸ ì˜ìƒ ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
                return;
            }

            sortedTopVideos.forEach((video, index) => {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.innerHTML = `
                    <img src="${video.Thumbnail || video['ì¸ë„¤ì¼'] || 'https://placehold.co/480x270/cccccc/333333?text=Video' + (index + 1)}" 
                         alt="${video.Title || video['ì œëª©'] || ''}" 
                         class="video-thumbnail"
                         onerror="this.src='https://placehold.co/480x270/cccccc/333333?text=Video${index + 1}'">
                    <div class="video-info">
                        <div class="video-title">${video.Title || video['ì œëª©'] || ''}</div>
                        <div class="video-stats">
                            ì¡°íšŒìˆ˜: ${formatNumber(video.Views || video['ì¡°íšŒìˆ˜'] || 0)} | 
                            ì¢‹ì•„ìš”: ${formatNumber(video.Likes || video['ì¢‹ì•„ìš”'] || 0)}
                        </div>
                        <a href="${video.Link || video['ë§í¬'] || '#'}" target="_blank" class="video-link">ì˜ìƒ ë³´ê¸°</a>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function updateNaverMainTable(data) {
            const tbody = document.getElementById('naverMainTableBody');
            tbody.innerHTML = '';
            
            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${row.Status || row['ê¸°ê°„'] || ''}</strong></td>
                    <td>${formatNumber(row.Join || row['íšŒì›ê°€ì…'] || 0)}</td>
                    <td>${formatNumber(row.Posts || row['ê²Œì‹œê¸€'] || 0)}</td>
                    <td>${formatNumber(row['Total Views'] || row['ì´ì¡°íšŒìˆ˜'] || 0)}</td>
                    <td>${formatNumber(row.Comments || row['ëŒ“ê¸€'] || 0)}</td>
                    <td>${formatNumber(row['Unique Visitors'] || row['ìˆœë°©ë¬¸ì'] || 0)}</td>
                    <td>${row['Avg Visits'] || row['í‰ê· ë°©ë¬¸'] || 0}</td>
                    <td>${row['Avg Duration'] || row['í‰ê· ì‹œê°„'] || '0s'}</td>
                    <td>${row['Return Rate'] || row['ì¬ë°©ë¬¸ìœ¨'] || '0%'}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function initializeCharts() {
            Chart.defaults.font.family = "'Segoe UI', sans-serif";
            Chart.defaults.plugins.legend.position = 'bottom';
        }

        function updateAllCharts() {
            updateYouTubeCharts();
            updateNaverCharts();
            updateAgeCharts();
        }

        function updateYouTubeCharts() {
            // YouTube ì¡°íšŒìˆ˜ ì°¨íŠ¸
            const ctx1 = document.getElementById('youtubeViewsChart');
            if (ctx1) {
                if (chartInstances.youtubeViews) chartInstances.youtubeViews.destroy();
                
                // Use data from uploadedData if available, otherwise use sample
                const youtubeData = uploadedData['Youtube']?.rows || sampleDataTemplates['youtube-total'].data.map(row => ({
                    Status: row[0],
                    'VOD Views': excelProcessor.parseNumericValue(row[3]),
                    'Shorts Views': excelProcessor.parseNumericValue(row[4]),
                    'Total Likes': excelProcessor.parseNumericValue(row[5])
                }));

                const labels = youtubeData.map(row => row.Status || row['ê¸°ê°„'] || row['Month']);
                const totalViews = youtubeData.map(row => (row['VOD Views'] || 0) + (row['Shorts Views'] || 0));
                const totalLikes = youtubeData.map(row => row['Total Likes'] || 0);

                chartInstances.youtubeViews = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ì´ ì¡°íšŒìˆ˜',
                            data: totalViews,
                            backgroundColor: 'rgba(255, 0, 0, 0.8)',
                            borderColor: 'rgba(255, 0, 0, 1)',
                            borderWidth: 1
                        }, {
                            label: 'ì´ ì¢‹ì•„ìš”',
                            data: totalLikes,
                            backgroundColor: 'rgba(255, 99, 132, 0.8)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // YouTube ì—…ë¡œë“œ ì°¨íŠ¸
            const ctx2 = document.getElementById('youtubeUploadsChart');
            if (ctx2) {
                if (chartInstances.youtubeUploads) chartInstances.youtubeUploads.destroy();
                
                const youtubeData = uploadedData['Youtube']?.rows || sampleDataTemplates['youtube-total'].data.map(row => ({
                    Status: row[0],
                    Videos: excelProcessor.parseNumericValue(row[2]) // Total videos
                }));

                const labels = youtubeData.map(row => row.Status || row['ê¸°ê°„'] || row['Month']);
                const videoCounts = youtubeData.map(row => row.Videos || 0);
                // Assuming shorts count is not directly available in 'Youtube' sheet,
                // if it's in 'Youtube(ALL)', we'd need to process that. For now, use a placeholder or derive if possible.
                // For this example, I'll use a simplified placeholder for shorts or derive from 'Youtube(ALL)' if available.
                // For simplicity, let's assume 'Shorts Views' can imply shorts count for now, or use a fixed sample.
                const shortsCounts = youtubeData.map(row => excelProcessor.parseNumericValue(row['Shorts Views'] || 0) > 0 ? 1 : 0); // Simplified: if shorts views > 0, count as 1 short video
                // A better approach would be to count distinct shorts from Youtube(ALL) if available.
                // For now, let's use a sample for shorts count if no direct data.
                const sampleShortsData = [4, 6, 8]; // Example placeholder

                chartInstances.youtubeUploads = new Chart(ctx2, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ì—…ë¡œë“œ ì˜ìƒ ìˆ˜',
                            data: videoCounts,
                            borderColor: 'rgba(54, 162, 235, 1)',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            tension: 0.4,
                            fill: false
                        }, {
                            label: 'ì—…ë¡œë“œ ì‡¼ì¸  ìˆ˜',
                            data: sampleShortsData, // Using sample for now, needs actual data if available
                            borderColor: 'rgba(255, 206, 86, 1)',
                            backgroundColor: 'rgba(255, 206, 86, 0.2)',
                            tension: 0.4,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function updateNaverCharts() {
            // Naver ë°©ë¬¸ì ì°¨íŠ¸
            const ctx1 = document.getElementById('naverVisitorsChart');
            if (ctx1) {
                if (chartInstances.naverVisitors) chartInstances.naverVisitors.destroy();
                
                const naverData = uploadedData['Naver Cafe']?.rows || sampleDataTemplates['naver-cafe'].data.map(row => ({
                    Status: row[0],
                    'Total Views': excelProcessor.parseNumericValue(row[3]),
                    'Unique Visitors': excelProcessor.parseNumericValue(row[5])
                }));

                const labels = naverData.map(row => row.Status || row['ê¸°ê°„']);
                const totalViews = naverData.map(row => row['Total Views'] || 0);
                const uniqueVisitors = naverData.map(row => row['Unique Visitors'] || 0);

                chartInstances.naverVisitors = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ì´ ì¡°íšŒìˆ˜',
                            data: totalViews,
                            backgroundColor: 'rgba(0, 199, 60, 0.8)',
                            borderColor: 'rgba(0, 199, 60, 1)',
                            borderWidth: 1
                        }, {
                            label: 'ìˆœ ë°©ë¬¸ì ìˆ˜',
                            data: uniqueVisitors,
                            backgroundColor: 'rgba(0, 150, 45, 0.8)',
                            borderColor: 'rgba(0, 150, 45, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Naver ê²Œì‹œê¸€ ì°¨íŠ¸
            const ctx2 = document.getElementById('naverPostsChart');
            if (ctx2) {
                if (chartInstances.naverPosts) chartInstances.naverPosts.destroy();
                
                const naverData = uploadedData['Naver Cafe']?.rows || sampleDataTemplates['naver-cafe'].data.map(row => ({
                    Status: row[0],
                    Posts: excelProcessor.parseNumericValue(row[2]),
                    Comments: excelProcessor.parseNumericValue(row[4])
                }));

                const labels = naverData.map(row => row.Status || row['ê¸°ê°„']);
                const posts = naverData.map(row => row.Posts || 0);
                const comments = naverData.map(row => row.Comments || 0);

                chartInstances.naverPosts = new Chart(ctx2, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ê²Œì‹œê¸€ ìˆ˜',
                            data: posts,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'ëŒ“ê¸€ ìˆ˜',
                            data: comments,
                            borderColor: 'rgba(153, 102, 255, 1)',
                            backgroundColor: 'rgba(153, 102, 255, 0.2)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function updateAgeCharts() {
            // ì—°ë ¹ëŒ€ ë¹„êµ ì°¨íŠ¸ (Using hardcoded sample for now, as DAU sheet doesn't have age breakdown)
            const ctx1 = document.getElementById('ageComparisonChart');
            if (ctx1) {
                if (chartInstances.ageComparison) chartInstances.ageComparison.destroy();
                
                chartInstances.ageComparison = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['10ëŒ€', '20ëŒ€', '30ëŒ€', '40ëŒ€+'],
                        datasets: [{
                            label: 'ë„¤ì´ë²„ ì¹´í˜',
                            data: [196418, 153453, 57974, 85007],
                            backgroundColor: 'rgba(0, 199, 60, 0.8)'
                        }, {
                            label: 'YouTube',
                            data: [142244, 131712, 51782, 80187],
                            backgroundColor: 'rgba(255, 0, 0, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // ì—°ë ¹ëŒ€ ì›”ë³„ ë³€í™” ì°¨íŠ¸ (Using hardcoded sample for now)
            const ctx2 = document.getElementById('ageMonthlyChart');
            if (ctx2) {
                if (chartInstances.ageMonthly) chartInstances.ageMonthly.destroy();
                
                chartInstances.ageMonthly = new Chart(ctx2, {
                    type: 'line',
                    data: {
                        labels: ['4ì›”', '5ì›”', '6ì›”'],
                        datasets: [{
                            label: '10ëŒ€',
                            data: [160618, 179263, 196418],
                            borderColor: 'rgba(54, 162, 235, 1)',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            tension: 0.4,
                            fill: false
                        }, {
                            label: '20ëŒ€',
                            data: [131712, 138393, 153453],
                            borderColor: 'rgba(255, 99, 132, 1)',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            tension: 0.4,
                            fill: false
                        }, {
                            label: '30ëŒ€',
                            data: [51782, 67609, 57974],
                            borderColor: 'rgba(255, 206, 86, 1)',
                            backgroundColor: 'rgba(255, 206, 86, 0.2)',
                            tension: 0.4,
                            fill: false
                        }, {
                            label: '40ëŒ€+',
                            data: [80187, 85410, 85007],
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            tension: 0.4,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function loadInitialData() {
            // Initial data load for tables
            const defaultYouTubeData = sampleDataTemplates['youtube-total'].data.map(row => ({
                Status: row[0], Subscriber: excelProcessor.parseNumericValue(row[1]), Videos: excelProcessor.parseNumericValue(row[2]), 
                'VOD Views': excelProcessor.parseNumericValue(row[3]), 'Shorts Views': excelProcessor.parseNumericValue(row[4]), 
                'Total Likes': excelProcessor.parseNumericValue(row[5]), 'VOD Likes': excelProcessor.parseNumericValue(row[6]), 
                'Shorts Likes': excelProcessor.parseNumericValue(row[7]), 'Community Views': excelProcessor.parseNumericValue(row[8]), 
                'Community Likes': excelProcessor.parseNumericValue(row[9]), 'Community Counts': excelProcessor.parseNumericValue(row[10])
            }));
            updateYouTubeMainTable(defaultYouTubeData);
            
            const defaultNaverData = sampleDataTemplates['naver-cafe'].data.map(row => ({
                Status: row[0], Join: excelProcessor.parseNumericValue(row[1]), Posts: excelProcessor.parseNumericValue(row[2]), 
                'Total Views': excelProcessor.parseNumericValue(row[3]), Comments: excelProcessor.parseNumericValue(row[4]), 
                'Unique Visitors': excelProcessor.parseNumericValue(row[5]), 'Avg Visits': row[6], 
                'Avg Duration': row[7], 'Return Rate': row[8]
            }));
            updateNaverMainTable(defaultNaverData);
            
            const defaultYouTubeDetail = sampleDataTemplates['youtube-detail'].data.map(row => ({
                Title: row[0], Views: excelProcessor.parseNumericValue(row[2]), Likes: excelProcessor.parseNumericValue(row[5]), 
                Link: row[8], Thumbnail: row[9]
            }));
            updateYouTubeDetailSection(defaultYouTubeDetail);

            // Default community data for the table
            const defaultCommunityData = {
                rows: [
                    { Status: '4ì›”', 'Community Counts': 13, 'Community Likes': 2596, 'Community Views': 120294, 'Community Comments': 100 },
                    { Status: '5ì›”', 'Community Counts': 24, 'Community Likes': 5659, 'Community Views': 330596, 'Community Comments': 200 },
                    { Status: '6ì›”', 'Community Counts': 15, 'Community Likes': 5456, 'Community Views': 228439, 'Community Comments': 150 }
                ],
                calculations: {
                    totalCommunityViews: 679329,
                    totalCommunityLikes: 13711,
                    totalCommunityPosts: 52,
                    averageEngagement: 2.018,
                    missingFields: []
                }
            };
            applyYoutubeCommunityData(defaultCommunityData);

            updateAllCharts(); // Update charts with default data
        }

        function formatNumber(num) {
            if (typeof num === 'string') {
                num = parseFloat(num.replace(/[,]/g, '')) || 0;
            }
            return new Intl.NumberFormat('ko-KR').format(num);
        }

        function setupPeriodSelectors() {
            const yearSelector = document.getElementById('yearSelector');
            const monthSelector = document.getElementById('monthSelector');
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth() + 1; // getMonth() is 0-indexed

            for (let i = currentYear - 2; i <= currentYear + 1; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i}ë…„`;
                yearSelector.appendChild(option);
            }

            for (let i = 1; i <= 12; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i}ì›”`;
                monthSelector.appendChild(option);
            }

            yearSelector.value = currentYear;
            monthSelector.value = currentMonth;

            yearSelector.addEventListener('change', updateReportDate);
            monthSelector.addEventListener('change', updateReportDate);
            updateReportDate(); // Initial call
        }

        function updateReportDate() {
            const year = document.getElementById('yearSelector').value;
            const month = document.getElementById('monthSelector').value;
            currentReportDate = new Date(year, month - 1, 1); // Month is 0-indexed for Date object

            const formattedDate = `${year}ë…„ ${month}ì›”`;
            document.getElementById('currentPeriod').textContent = formattedDate;

            const dateStr = currentReportDate.toISOString().split('T')[0].replace(/-/g, '.');
            document.getElementById('reportDate').textContent = dateStr;
            document.getElementById('endDate').textContent = dateStr;
        }

        function generateReport() {
            showNotification('ğŸ“„ ë¦¬í¬íŠ¸ë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...', 'info');
            setTimeout(() => {
                showNotification('âœ… ë¦¬í¬íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }, 2000);
        }

        function exportToPDF() {
            showNotification('ğŸ“¥ PDFë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...', 'info');
            
            const element = document.querySelector('.main-content');
            const opt = {
                margin: 1,
                filename: `clash_royale_monthly_review_${currentReportDate.toISOString().split('T')[0]}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            
            html2pdf().set(opt).from(element).save().then(() => {
                showNotification('âœ… PDFê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            });
        }

        function openAdminPanel() {
            document.getElementById('adminModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeAdminPanel() {
            document.getElementById('adminModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Custom Content Features
        function setupCustomContentModal() {
            const contentTypeSelector = document.getElementById('contentTypeSelector');
            contentTypeSelector.addEventListener('change', function() {
                document.getElementById('textInputGroup').style.display = 'none';
                document.getElementById('imageInputGroup').style.display = 'none';
                if (this.value === 'text') {
                    document.getElementById('textInputGroup').style.display = 'block';
                } else if (this.value === 'image') {
                    document.getElementById('imageInputGroup').style.display = 'block';
                }
            });
        }

        function openAddCustomContentModal() {
            document.getElementById('addCustomContentModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            // Reset form
            document.getElementById('customContentText').value = '';
            document.getElementById('customContentImageUrl').value = '';
            document.getElementById('customContentImageAlt').value = '';
            document.getElementById('contentTypeSelector').value = 'text';
            document.getElementById('textInputGroup').style.display = 'block';
            document.getElementById('imageInputGroup').style.display = 'none';
        }

        function closeAddCustomContentModal() {
            document.getElementById('addCustomContentModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function addCustomContent() {
            const sectionId = document.getElementById('contentSectionSelector').value;
            const contentType = document.getElementById('contentTypeSelector').value;
            const targetSection = document.getElementById(`${sectionId}-custom-content`);

            if (!targetSection) {
                showNotification('âŒ ì„ íƒëœ ì„¹ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            const wrapper = document.createElement('div');
            wrapper.className = 'editable-content-wrapper';
            wrapper.innerHTML = `
                <div class="content-header">
                    <span>${contentType === 'text' ? 'ì‚¬ìš©ì ì •ì˜ í…ìŠ¤íŠ¸' : 'ì‚¬ìš©ì ì •ì˜ ì´ë¯¸ì§€'}</span>
                    <button onclick="this.closest('.editable-content-wrapper').remove()">&#x2715;</button>
                </div>
            `;

            if (contentType === 'text') {
                const text = document.getElementById('customContentText').value;
                const textBlock = document.createElement('div');
                textBlock.className = 'editable-text-block';
                textBlock.contentEditable = true;
                textBlock.innerHTML = text || 'í´ë¦­í•˜ì—¬ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...';
                wrapper.appendChild(textBlock);
            } else if (contentType === 'image') {
                const imageUrl = document.getElementById('customContentImageUrl').value;
                const imageAlt = document.getElementById('customContentImageAlt').value;
                const imageBlock = document.createElement('div');
                imageBlock.className = 'editable-image-block';
                imageBlock.innerHTML = `
                    <img src="${imageUrl || 'https://placehold.co/300x200?text=No+Image'}" alt="${imageAlt || 'ì‚¬ìš©ì ì •ì˜ ì´ë¯¸ì§€'}">
                    <input type="text" value="${imageUrl}" placeholder="ì´ë¯¸ì§€ URL" onchange="this.previousElementSibling.src=this.value || 'https://placehold.co/300x200?text=No+Image'">
                    <input type="text" value="${imageAlt}" placeholder="ì´ë¯¸ì§€ ì„¤ëª…" onchange="this.previousElementSibling.previousElementSibling.alt=this.value">
                `;
                wrapper.appendChild(imageBlock);
            }

            targetSection.appendChild(wrapper);
            showNotification('âœ… ì»¤ìŠ¤í…€ ì½˜í…ì¸ ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            closeAddCustomContentModal();
        }

        // AI Key Issues Generation
        async function generateAIKeyIssues() {
            showNotification('âœ¨ AIê°€ ì£¼ìš” ì´ìŠˆë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...', 'info');
            const positiveIssuesDiv = document.querySelector('#key-issues .insights-panel:first-of-type');
            const negativeIssuesDiv = document.querySelector('#key-issues .insights-panel:last-of-type');

            // Clear existing AI-generated content (keep manual edits)
            positiveIssuesDiv.querySelectorAll('.insight-item:not([contenteditable="true"])').forEach(el => el.remove());
            negativeIssuesDiv.querySelectorAll('.insight-item:not([contenteditable="true"])').forEach(el => el.remove());

            // Prepare prompt based on available data
            let prompt = "í´ë˜ì‹œ ë¡œì–„ ì›”ê°„ ì»¤ë®¤ë‹ˆí‹° ë¦¬ë·° ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì£¼ìš” ê¸ì •ì  ì´ìŠˆì™€ ë¶€ì •ì  ì´ìŠˆë¥¼ ê°ê° 3~5ê°€ì§€ì”© ìš”ì•½í•´ì¤˜. ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì•„:\n\n";
            
            if (excelProcessor.processedData) {
                const sheets = excelProcessor.processedData.processedSheets;
                const calcs = excelProcessor.processedData.calculatedFields;

                if (sheets['Youtube']) {
                    prompt += "--- YouTube ì¢…í•© ë°ì´í„° ---\n";
                    sheets['Youtube'].rows.forEach(row => {
                        prompt += `ì›”: ${row.Status || 'N/A'}, êµ¬ë…ì: ${row.Subscriber || 'N/A'}, ì´ ì¡°íšŒìˆ˜: ${excelProcessor.findFieldValue(row, ['VOD Views', 'Shorts Views']) || 'N/A'}, ì´ ì¢‹ì•„ìš”: ${row['Total Likes'] || 'N/A'}\n`;
                    });
                    if (calcs.youtubeGrowth) {
                        prompt += `êµ¬ë…ì ì„±ì¥ë¥ : ${calcs.youtubeGrowth.Subscriber || 'N/A'}%\n`;
                    }
                    prompt += "\n";
                }

                if (sheets['Youtube(ALL)']) {
                    prompt += "--- YouTube ìƒì„¸ ì˜ìƒ ë°ì´í„° (ìƒìœ„ 3ê°œ) ---\n";
                    (calcs.topPerformers?.topThree || []).forEach(video => {
                        prompt += `ì œëª©: ${video.title}, ì¡°íšŒìˆ˜: ${video.views}, ì¢‹ì•„ìš”: ${video.likes}\n`;
                    });
                    prompt += `í‰ê·  VOD ì¡°íšŒìˆ˜: ${calcs.averageViewsPerVideo || 'N/A'}\n`;
                    prompt += "\n";
                }

                if (sheets['Naver Cafe']) {
                    prompt += "--- Naver Cafe ì¢…í•© ë°ì´í„° ---\n";
                    sheets['Naver Cafe'].rows.forEach(row => {
                        prompt += `ì›”: ${row.Status || 'N/A'}, ê²Œì‹œê¸€ ìˆ˜: ${excelProcessor.findFieldValue(row, ['Posts', 'ê²Œì‹œê¸€ìˆ˜']) || 'N/A'}, ì´ ì¡°íšŒìˆ˜: ${excelProcessor.findFieldValue(row, ['Total Views', 'ì¡°íšŒìˆ˜']) || 'N/A'}, ëŒ“ê¸€ ìˆ˜: ${excelProcessor.findFieldValue(row, ['Comments', 'ëŒ“ê¸€ìˆ˜']) || 'N/A'}, ìˆœë°©ë¬¸ì ìˆ˜: ${excelProcessor.findFieldValue(row, ['Unique Visitors', 'ìˆœë°©ë¬¸ììˆ˜']) || 'N/A'}\n`;
                    });
                    if (calcs.naverEngagement) {
                        prompt += `ê²Œì‹œë¬¼ë‹¹ í‰ê·  ëŒ“ê¸€: ${calcs.naverEngagement.commentsPerPost || 'N/A'}\n`;
                    }
                    prompt += "\n";
                }

                if (sheets['Youtube community']) {
                    prompt += "--- YouTube ì»¤ë®¤ë‹ˆí‹° ë°ì´í„° ---\n";
                    sheets['Youtube community'].rows.forEach(row => {
                        prompt += `ì›”: ${row.Status || 'N/A'}, ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œë¬¼: ${excelProcessor.findFieldValue(row, ['Community Counts']) || 'N/A'}, ì¢‹ì•„ìš”: ${excelProcessor.findFieldValue(row, ['Community Likes']) || 'N/A'}, ì¡°íšŒìˆ˜: ${excelProcessor.findFieldValue(row, ['Community Views']) || 'N/A'}\n`;
                    });
                    prompt += "\n";
                }

                // Add age analysis insights if available (currently hardcoded, but if dynamic, add here)
                prompt += "--- ì—°ë ¹ì¸µ ë¶„ì„ (í˜„ì¬ ë°ì´í„° ê¸°ë°˜) ---\n";
                prompt += "ë„¤ì´ë²„ ì¹´í˜ ì´ìš©ìì˜ ì•½ 38%ê°€ 10ëŒ€ ì´ˆë°˜-í›„ë°˜ì— ì§‘ì¤‘ë˜ì–´ ìˆìœ¼ë©°, ìœ íŠœë¸ŒëŠ” 10ëŒ€ í›„ë°˜(30%) - 30ëŒ€ ì´ˆë°˜(22%) ì´ìš©ì ë¹„ì¤‘ì´ ì ˆë°˜ ì´ìƒì„ ì°¨ì§€í•˜ê³  ìˆìŒ.\n";
                prompt += "ë„¤ì´ë²„ ì¹´í˜ëŠ” 24ë…„ í›„ë°˜ ~ 25ë…„ ì´ˆë°˜ê¹Œì§€ 10ëŒ€ í›„ë°˜ - 20ëŒ€ ì´ˆë°˜ ìœ„ì£¼ë¡œ ì»¤ë®¤ë‹ˆí‹°ê°€ í˜•ì„±ë˜ì–´ ìˆì—ˆìœ¼ë‚˜, ìµœê·¼ 10ëŒ€ì˜ ë¹„ì¤‘ì´ ì§€ì†ì ìœ¼ë¡œ ìƒìŠ¹í•˜ê³  ìˆìŒ.\n";
                prompt += "ìœ íŠœë¸ŒëŠ” 35ì„¸~44ì„¸ë¡œ ë‹¤ì†Œ ë†’ì€ ì´ìš©ì ì—°ë ¹ëŒ€ë¥¼ ë³´ì˜€ìœ¼ë‚˜, ìµœê·¼ì—ëŠ” ë†’ì€ ì—°ë ¹ëŒ€ ë¹„ì¤‘ì´ í¬ê²Œ ì¤„ê³  20ëŒ€ ì´ˆë°˜ ì´ìš©ìê°€ ë¹ ë¥´ê²Œ ì¦ê°€í•˜ëŠ” ì¶”ì„¸ì„\n";
                prompt += "\n";

            } else {
                prompt += "í˜„ì¬ ì—…ë¡œë“œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¼ë°˜ì ì¸ í´ë˜ì‹œ ë¡œì–„ ì»¤ë®¤ë‹ˆí‹° ì´ìŠˆë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n";
                prompt += "--- ìƒ˜í”Œ ë°ì´í„° ê¸°ë°˜ ì¼ë°˜ì ì¸ ì´ìŠˆ --- \n";
                prompt += "ê¸ì •ì : ì‹ ê·œ ì—…ë°ì´íŠ¸ì— ëŒ€í•œ ê¸°ëŒ€ê°, ë°¸ëŸ°ìŠ¤ íŒ¨ì¹˜ì— ëŒ€í•œ ê¸ì •ì  ë°˜ì‘, í¬ë¦¬ì—ì´í„° ì½˜í…ì¸  í™œì„±í™”.\n";
                prompt += "ë¶€ì •ì : íŠ¹ì • ì¹´ë“œ ë„ˆí”„/ë²„í”„ ë¶ˆë§Œ, ë§¤ì¹­ ì‹œìŠ¤í…œ ë¶ˆê³µì •ì„±, ë²„ê·¸ ë° ê¸°ìˆ ì  ë¬¸ì œ.\n";
            }

            prompt += "ìœ„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í´ë˜ì‹œ ë¡œì–„ ì»¤ë®¤ë‹ˆí‹°ì˜ ì£¼ìš” ê¸ì •ì  ì´ìŠˆì™€ ë¶€ì •ì  ì´ìŠˆë¥¼ ê°ê° 3~5ê°€ì§€ì”© ìš”ì•½í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì¤˜. ê° ì´ìŠˆëŠ” ê°„ê²°í•œ ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±í•´ì¤˜. í˜•ì‹ì€ ë‹¤ìŒê³¼ ê°™ì•„: {\"positives\":[\"ì´ìŠˆ1\", \"ì´ìŠˆ2\"], \"negatives\":[\"ì´ìŠˆ1\", \"ì´ìŠˆ2\"]}";

            try {
                const payload = {
                    contents: [{ role: "user", parts: [{ text: prompt }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                "positives": { "type": "ARRAY", "items": { "type": "STRING" } },
                                "negatives": { "type": "ARRAY", "items": { "type": "STRING" } }
                            },
                            "propertyOrdering": ["positives", "negatives"]
                        }
                    }
                };
                const apiKey = ""; // Canvas will provide this
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API Error: ${response.status} - ${errorText}`);
                }

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const jsonString = result.candidates[0].content.parts[0].text;
                    const parsedJson = JSON.parse(jsonString);

                    // Append AI-generated issues
                    parsedJson.positives.forEach(issue => {
                        const div = document.createElement('div');
                        div.className = 'insight-item positive';
                        div.contentEditable = true;
                        div.innerHTML = `<p>${issue}</p>`;
                        positiveIssuesDiv.appendChild(div);
                    });

                    parsedJson.negatives.forEach(issue => {
                        const div = document.createElement('div');
                        div.className = 'insight-item negative';
                        div.contentEditable = true;
                        div.innerHTML = `<p>${issue}</p>`;
                        negativeIssuesDiv.appendChild(div);
                    });

                    showNotification('âœ… AIê°€ ì£¼ìš” ì´ìŠˆë¥¼ ì„±ê³µì ìœ¼ë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤!', 'success');
                } else {
                    throw new Error('AI ì‘ë‹µ êµ¬ì¡°ê°€ ì˜ˆìƒê³¼ ë‹¤ë¦…ë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('AI ì£¼ìš” ì´ìŠˆ ìƒì„± ì˜¤ë¥˜:', error);
                showNotification(`âŒ AI ì´ìŠˆ ìƒì„± ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }


        // ì „ì—­ ë””ë²„ê¹… ê°ì²´
        window.clashRoyaleReportSystem = {
            uploadedData,
            chartInstances,
            excelProcessor,
            downloadSample,
            showNotification,
            updateAllCharts,
            handleFileUpload,
            generateAIKeyIssues // Expose AI function
        };

        console.log('ğŸ® í´ë˜ì‹œ ë¡œì–„ ì‹¤ì œ ì—…ë¬´ìš© ì»¤ë®¤ë‹ˆí‹° ë¦¬ë·° ì‹œìŠ¤í…œ ì™„ì„±!');
        console.log('');
        console.log('ğŸ“Š ì§€ì› ê¸°ëŠ¥:');
        console.log('  âœ… Excel íŒŒì¼ (.xlsx) ì „ì²´ ì‹œíŠ¸ ìë™ ì¸ì‹');
        console.log('  âœ… í•„ìˆ˜ ì‹œíŠ¸: Naver Cafe, Youtube, Youtube(ALL), Youtube community');
        console.log('  âœ… ìë™ ê³„ì‚°: í•©ê³„, í‰ê· , ì„±ì¥ë¥ , ì°¸ì—¬ë„');
        console.log('  âœ… ë°ì´í„° í’ˆì§ˆ ê²€ì¦ ë° ëˆ„ë½ í•„ë“œ ì•Œë¦¼');
        console.log('  âœ… AIê°€ ì„ì˜ ë°ì´í„° ìƒì„±í•˜ì§€ ì•ŠìŒ');
        console.log('  âœ… CSV íŒŒì¼ í˜¸í™˜ (ê°œë³„ ì—…ë¡œë“œ)');
        console.log('  âœ… ì „ë¬¸ PDF ë‚´ë³´ë‚´ê¸°');
        console.log('  âœ… ë¦¬í¬íŠ¸ í…ìŠ¤íŠ¸ ë° ì œëª© ì§ì ‘ ìˆ˜ì • ê°€ëŠ¥ (í´ë¦­í•˜ì—¬ í¸ì§‘)');
        console.log('  âœ… ì»¤ìŠ¤í…€ í…ìŠ¤íŠ¸/ì´ë¯¸ì§€ ë¸”ë¡ ì¶”ê°€ ê°€ëŠ¥');
        console.log('  âœ… ë…„ë„/ì›” ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ë¦¬í¬íŠ¸ ê¸°ê°„ ì„ íƒ ê°€ëŠ¥');
        console.log('  âœ… AIê°€ ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ì£¼ìš” ì´ìŠˆ ìë™ ìƒì„± (ìˆ˜ì • ê°€ëŠ¥)');
        console.log('');
        console.log('ğŸš€ ì‚¬ìš©ë²•:');
        console.log('  1. ê´€ë¦¬ì íŒ¨ë„ ì—´ê¸°');
        console.log('  2. Excel íŒŒì¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­');
        console.log('  3. ìë™ ë¶„ì„ ê²°ê³¼ í™•ì¸ í›„ "ë°ì´í„° ì ìš©"');
        console.log('  4. ë¦¬í¬íŠ¸ ë‚´ í…ìŠ¤íŠ¸ë¥¼ í´ë¦­í•˜ì—¬ ì§ì ‘ ìˆ˜ì •');
        console.log('  5. ê´€ë¦¬ì íŒ¨ë„ì—ì„œ "ì»¤ìŠ¤í…€ ì½˜í…ì¸  ì¶”ê°€"ë¡œ í…ìŠ¤íŠ¸/ì´ë¯¸ì§€ ë¸”ë¡ ì¶”ê°€');
        console.log('  6. "ì£¼ìš” ì´ìŠˆ" ì„¹ì…˜ì—ì„œ "AIê°€ ì£¼ìš” ì´ìŠˆ ìƒì„±" ë²„íŠ¼ í´ë¦­');
        console.log('  7. PDF ë‚´ë³´ë‚´ê¸°');
        console.log('');
        console.log('ğŸ”§ ë””ë²„ê¹…: window.clashRoyaleReportSystem');
        console.log('ğŸ“‚ Excel ì‹œíŠ¸ êµ¬ì¡° ì˜ˆì‹œ:');
        console.log('  â€¢ Naver Cafe: ê¸°ê°„, ì¡°íšŒìˆ˜, ê²Œì‹œê¸€ìˆ˜, ëŒ“ê¸€ìˆ˜, ì‹ ê·œê°€ì…ììˆ˜');
        console.log('  â€¢ Youtube: Status, Subscriber, VOD Views, Shorts Views, Total Likes');
        console.log('  â€¢ Youtube(ALL): Title, Views, Likes, Link, Thumbnail');
        console.log('  â€¢ Youtube community: Community Views, Community Likes, Community Counts');
    </script>
</body>
</html>
